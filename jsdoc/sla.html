<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Namespace: sla</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Namespace: sla</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>sla<span class="signature">()</span><span class="type-signature"></span></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    

    















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_slacoeffs.js.html">visplot_slacoeffs.js</a>, <a href="visplot_slacoeffs.js.html#line15">line 15</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id=".airmas"><span class="type-signature">(static) </span>airmas<span class="signature">(zd)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Air Mass</strong></p></p>
    



<div class="description">
    <p>Air mass at given zenith distance.</p>
<ol>
<li>The <em>observed</em> zenith distance referred to above means “as affected by
refraction”.</li>
<li>The routine uses Hardie’s (1962) polynomial fit to Bemporad’s data
for the relative air mass, X, in units of thickness at the zenith as
tabulated by Schoenberg (1929). This is adequate for all normal needs
as it is accurate to better than 0.1% up to X=6.8 and better than 1%
up to X=10. Bemporad’s tabulated values are unlikely to be trustworthy
to such accuracy because of variations in density, pressure and other
conditions in the atmosphere from those assumed in his work.</li>
<li>The sign of the ZD is ignored.</li>
<li>At zenith distances greater than about ζ=87° the air mass is held
constant to avoid arithmetic overflows.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Hardie, R.H., 1962, in <em>Astronomical Techniques</em> ed. W.A. Hiltner,
University of Chicago Press, p.180.</li>
<li>Schoenberg, E., 1929, Hdb. d. Ap., Berlin, Julius Springer, 2, 268.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>zd</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observed zenith distance (radians).</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line101">line 101</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss3.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss3.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Air mass (1 at zenith).</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".aop"><span class="type-signature">(static) </span>aop<span class="signature">(rap, dap, date, dut, elongm, phim, hm, xp, yp, tdk, pmb, rh, wl, tlr)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Apparent to Observed</strong></p></p>
    



<div class="description">
    <p>Apparent to observed place, for sources distant from the
solar system.</p>
<ol>
<li>This routine returns zenith distance rather than elevation in order to
reflect the fact that no allowance is made for depression of the horizon.</li>
<li>The accuracy of the result is limited by the corrections for refraction.
Providing the meteorological parameters are known accurately and there
are no gross local effects, the predicted azimuth and elevation should
be within about ′′01 for ζ&lt;70°. Even at a topocentric zenith distance of
90°, the accuracy in elevation should be better than 1 arcminute; useful
results are available for a further 3°, beyond which the <a href="sla.html#.refro">sla.refro</a>
routine returns a fixed value of the refraction. The complementary
routines <a href="sla.html#.aop">sla.aop</a> (or <a href="sla.html#.aopqk">sla.aopqk</a>) and sla.oap (or
sla.oapqk are self-consistent to better than 1 microarcsecond all
over the celestial sphere.</li>
<li>It is advisable to take great care with units, as even unlikely values
of the input parameters are accepted and processed in accordance with
the models used.</li>
<li><em>Apparent</em> [<em>α</em>,<em>δ</em>] means the geocentric apparent right ascension and
declination, which is obtained from a catalogue mean place by allowing
for space motion, parallax, the Sun’s gravitational lens effect, annual
aberration, and precession-nutation. For star positions in the FK5 system
(i.e. J2000), these effects can be applied by means of the <a href="sla.html#.map">sla.map</a>
etc. routines. Starting from other mean place systems, additional
transformations will be needed; for example, FK4 (i.e. B1950) mean places
would first have to be converted to FK5, which can be done with the
<a href="sla.html#.fk425">sla.fk425</a> etc. routines.</li>
<li><em>Observed</em> [<em>Az</em>,<em>El</em>] means the position that would be seen by a perfect
theodolite located at the observer. This is obtained from the geocentric
apparent [<em>α</em>,<em>δ</em>] by allowing for Earth orientation and diurnal
aberration, rotating from equator to horizon coordinates, and then
adjusting for refraction. The [<em>h</em>,<em>δ</em>] is obtained by rotating back into
equatorial coordinates, using the geodetic latitude corrected for polar
motion, and is the position that would be seen by a perfect equatorial
located at the observer and with its polar axis aligned to the Earth’s
axis of rotation (n.b. not to the refracted pole). Finally, the <em>α</em> is
obtained by subtracting the <em>h</em> from the local apparent ST.</li>
<li>To predict the required setting of a real telescope, the observed place
produced by this routine would have to be adjusted for the tilt of the
azimuth or polar axis of the mounting (with appropriate corrections for
mount flexures), for non-perpendicularity between the mounting axes, for
the position of the rotator axis and the pointing axis relative to it,
for tube flexure, for gear and encoder errors, and finally for encoder
zero points. Some telescopes would, of course, exhibit other properties
which would need to be accounted for at the appropriate point in the
sequence.</li>
<li>This routine takes time to execute, due mainly to the rigorous integration
used to evaluate the refraction. For processing multiple stars for one
location and time, call <a href="sla.html#.aoppa">sla.aoppa</a> once followed by one call per
star to <a href="sla.html#.aopqk">sla.aopqk</a>. Where a range of times within a limited period
of a few hours is involved, and the highest precision is not required,
call <a href="sla.html#.aoppa">sla.aoppa</a> once, followed by a call to <a href="sla.html#.aoppat">sla.aoppat</a>
each time the time changes, followed by one call per star to
<a href="sla.html#.aopqk">sla.aopqk</a>.</li>
<li>The DATE argument is UTC expressed as an MJD. This is, strictly speaking,
wrong, because of leap seconds. However, as long as the ΔUT and the UTC
are consistent there are no difficulties, except during a leap second.
In this case, the start of the 61st second of the final minute should
begin a new MJD day and the old pre-leap ΔUT should continue to be used.
As the 61st second completes, the MJD should revert to the start of the
day as, simultaneously, the ΔUT changes by one second to its post-leap
new value.</li>
<li>The ΔUT (UT1−UTC) is tabulated in IERS circulars and elsewhere. It
increases by exactly one second at the end of each UTC leap second,
introduced in order to keep ΔUT within ±0.9s.</li>
<li>IMPORTANT − TAKE CARE WITH THE LONGITUDE SIGN CONVENTION. The longitude
required by the present routine is <strong>east-positive</strong>, in accordance with
geographical convention (and right-handed). In particular, note that
the longitudes returned by the sla.obs routine are west-positive
(as in the <em>Astronomical Almanac</em> before 1984) and must be reversed in
sign before use in the present routine.</li>
<li>The polar coordinates XP,YP can be obtained from IERS circulars and
equivalent publications. The maximum amplitude is about ′′03. If XP,YP
values are unavailable, use XP=YP=0. See page B60 of the 1988
<em>Astronomical Almanac</em> for a definition of the two angles.</li>
<li>The height above sea level of the observing station, HM, can be obtained
from the <em>Astronomical Almanac</em> (Section J in the 1988 edition), or via
the routine sla.obs. If P, the pressure in millibars, is
available, an adequate estimate of HM can be obtained from the following
expression:
HM = -29.3 * TSL * Math.log(P / 1013.25)
where TSL is the approximate sea-level air temperature in K (see
<em>Astrophysical Quantities</em>, C.W.Allen, 3rd edition, §52). Similarly, if
the pressure P is not known, it can be estimated from the height of the
observing station, HM as follows:
P = 1013.25 * Math.exp(-HM / (29.3 * TSL))
Note, however, that the refraction is nearly proportional to the pressure
and that an accurate P value is important for precise work.</li>
<li>The azimuths etc. used by the present routine are with respect to the
celestial pole. Corrections to the terrestrial pole can be computed using
<a href="sla.html#.polmo">sla.polmo</a>.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rap</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>geocentric apparent <em>α</em> (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dap</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>geocentric apparent <em>δ</em> (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UTC date/time (Modified Julian Date, JD−2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dut</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>ΔUT: UT1−UTC (UTC seconds)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>elongm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s mean longitude (radians, east +ve)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phim</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s mean geodetic latitude (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>hm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s height above sea level (metres)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>xp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>polar motion <em>x</em> coordinate (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>yp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>polar motion <em>y</em> coordinate (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tdk</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local ambient temperature (K; std=273.15)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local atmospheric pressure (mb; std=1013.25)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local relative humidity (in the range 0−1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>effective wavelength (μm, e.g. 0.55)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tlr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>tropospheric lapse rate (K per metre, e.g. 0.0065)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line220">line 220</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss7.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss7.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <ul>
<li>aob - observed azimuth (radians: N=0, E=90°)</li>
<li>zob - observed zenith distance (radians)</li>
<li>hob - observed Hour Angle (radians)</li>
<li>dob - observed <em>δ</em> (radians)</li>
<li>rob - observed <em>α</em> (radians)</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".aoppa"><span class="type-signature">(static) </span>aoppa<span class="signature">(date, dut, elongm, phim, hm, xp,, tdk, pmb, rh, wl, tlr)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Appt-to-Obs Parameters</strong></p></p>
    



<div class="description">
    <p>Pre-compute the set of apparent to observed place parameters
required by the “quick” routines <a href="sla.html#.aopqk">sla.aopqk</a> and
sla.oapqk.</p>
<ol>
<li>It is advisable to take great care with units, as even unlikely values
of the input parameters are accepted and processed in accordance with
the models used.</li>
<li>The DATE argument is UTC expressed as an MJD. This is, strictly speaking,
wrong, because of leap seconds. However, as long as the ΔUT and the UTC
are consistent there are no difficulties, except during a leap second.
In this case, the start of the 61st second of the final minute should
begin a new MJD day and the old pre-leap ΔUT should continue to be used.
As the 61st second completes, the MJD should revert to the start of the
day as, simultaneously, the ΔUT changes by one second to its post-leap
new value.</li>
<li>The ΔUT (UT1−UTC) is tabulated in IERS circulars and elsewhere. It
increases by exactly one second at the end of each UTC leap second,
introduced in order to keep ΔUT within ±0.9s.</li>
<li>IMPORTANT − TAKE CARE WITH THE LONGITUDE SIGN CONVENTION. The longitude
required by the present routine is <strong>east-positive</strong>, in accordance with
geographical convention (and right-handed). In particular, note that
the longitudes returned by the sla.obs routine are west-positive
(as in the <em>Astronomical Almanac</em> before 1984) and must be reversed in
sign before use in the present routine.</li>
<li>The polar coordinates XP,YP can be obtained from IERS circulars and
equivalent publications. The maximum amplitude is about ′′03. If XP,YP
values are unavailable, use XP=YP=0. See page B60 of the 1988
<em>Astronomical Almanac</em> for a definition of the two angles.</li>
<li>The height above sea level of the observing station, HM, can be obtained
from the <em>Astronomical Almanac</em> (Section J in the 1988 edition), or via
the routine sla.obs. If P, the pressure in millibars, is
available, an adequate estimate of HM can be obtained from the following
expression:
HM = -29.3 * TSL * Math.log(P / 1013.25)
where TSL is the approximate sea-level air temperature in K (see
<em>Astrophysical Quantities</em>, C.W.Allen, 3rd edition, §52). Similarly, if
the pressure P is not known, it can be estimated from the height of the
observing station, HM as follows:
P = 1013.25 * Math.exp(-HM / (29.3 * TSL))
Note, however, that the refraction is nearly proportional to the pressure
and that an accurate P value is important for precise work.</li>
<li>Repeated, computationally-expensive, calls to <a href="sla.html#.aoppa">sla.aoppa</a> for times
that are very close together can be avoided by calling <a href="sla.html#.aoppa">sla.aoppa</a>
just once and then using <a href="sla.html#.aoppat">sla.aoppat</a> for the subsequent times.
Fresh calls to <a href="sla.html#.aoppa">sla.aoppa</a> will be needed only when changes in the
precession have grown to unacceptable levels or when anything affecting
the refraction has changed.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UTC date/time (Modified Julian Date, JD–2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dut</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>ΔUT: UT1–UTC (UTC seconds)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>elongm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s mean longitude (radians, east +ve)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phim</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s mean geodetic latitude (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>hm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>observer’s height above sea level (metres)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>xp,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>yp - polar motion [x,y] coordinates (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tdk</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local ambient temperature (K; std=273.15)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local atmospheric pressure (mb; std=1013.25)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>local relative humidity (in the range 0–1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>effective wavelength (um, e.g. 0.55)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tlr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>tropospheric lapse rate (K per metre, e.g. 0.0065)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line303">line 303</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss8.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss8.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>star-independent apparent-to-observed parameters:
[0] geodetic latitude (radians)
[1,2] sine and cosine of geodetic latitude
[3] magnitude of diurnal aberration vector
[4] height (HM)
[5] ambient temperature (TDK)
[6] pressure (PMB)
[7] relative humidity (RH)
[8] wavelength (WL)
[9] lapse rate (TLR)
[10,11] refraction constants A and B (radians)
[12] longitude + eqn of equinoxes + “sidereal dUT” (radians)
[13] local apparent sidereal time (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".aoppat"><span class="type-signature">(static) </span>aoppat<span class="signature">(date, aoprms)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Update Appt-to-Obs Parameters</strong></p></p>
    



<div class="description">
    <p>Recompute the sidereal time in the apparent to observed place
star-independent parameter block.</p>
<ul>
<li>For more information, see <a href="sla.html#.aoppa">sla.aoppa</a>.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UTC date/time (modified Julian Date, JD-2400000.5)
(see <a href="sla.html#.aoppa">sla.aoppa</a> for comments on leap seconds)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aoprms</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>Star-independent apparent-to-observed parameters
[0-11] not required
[12] longitude + eqn of equinoxes + sidereal DUT
[13] not required</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line359">line 359</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss9.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss9.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Star-independent apparent-to-observed parameters:
[0-12] not changed
[13] local apparent sidereal time (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".aopqk"><span class="type-signature">(static) </span>aopqk<span class="signature">(rap, dap, aoprms)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Quick Appt-to-Observed</strong></p></p>
    



<div class="description">
    <p>Quick apparent to observed place (but see Note 8, below).</p>
<ol>
<li>This routine returns zenith distance rather than elevation in order to
reflect the fact that no allowance is made for depression of the horizon.</li>
<li>The accuracy of the result is limited by the corrections for refraction.
Providing the meteorological parameters are known accurately and there
are no gross local effects, the predicted azimuth and elevation should
be within about ′′01 for ζ&lt;70°. Even at a topocentric zenith distance of
90°, the accuracy in elevation should be better than 1 arcminute; useful
results are available for a further 3°, beyond which the <a href="sla.html#.refro">sla.refro</a>
routine returns a fixed value of the refraction. The complementary
routines <a href="sla.html#.aop">sla.aop</a> (or <a href="sla.html#.aopqk">sla.aopqk</a>) and sla.oap (or
sla.oapqk are self-consistent to better than 1 microarcsecond all
over the celestial sphere.</li>
<li>It is advisable to take great care with units, as even unlikely values
of the input parameters are accepted and processed in accordance with
the models used.</li>
<li><em>Apparent</em> [<em>α</em>,<em>δ</em>] means the geocentric apparent right ascension and
declination, which is obtained from a catalogue mean place by allowing
for space motion, parallax, the Sun’s gravitational lens effect, annual
aberration, and precession-nutation. For star positions in the FK5 system
(i.e. J2000), these effects can be applied by means of the <a href="sla.html#.map">sla.map</a>
etc. routines. Starting from other mean place systems, additional
transformations will be needed; for example, FK4 (i.e. B1950) mean places
would first have to be converted to FK5, which can be done with the
<a href="sla.html#.fk425">sla.fk425</a> etc. routines.</li>
<li><em>Observed</em> [<em>Az</em>,<em>El</em>] means the position that would be seen by a perfect
theodolite located at the observer. This is obtained from the geocentric
apparent [<em>α</em>,<em>δ</em>] by allowing for Earth orientation and diurnal
aberration, rotating from equator to horizon coordinates, and then
adjusting for refraction. The [<em>h</em>,<em>δ</em>] is obtained by rotating back into
equatorial coordinates, using the geodetic latitude corrected for polar
motion, and is the position that would be seen by a perfect equatorial
located at the observer and with its polar axis aligned to the Earth’s
axis of rotation (n.b. not to the refracted pole). Finally, the <em>α</em> is
obtained by subtracting the <em>h</em> from the local apparent ST.</li>
<li>To predict the required setting of a real telescope, the observed place
produced by this routine would have to be adjusted for the tilt of the
azimuth or polar axis of the mounting (with appropriate corrections for
mount flexures), for non-perpendicularity between the mounting axes, for
the position of the rotator axis and the pointing axis relative to it,
for tube flexure, for gear and encoder errors, and finally for encoder
zero points. Some telescopes would, of course, exhibit other properties
which would need to be accounted for at the appropriate point in the
sequence.</li>
<li>The star-independent apparent-to-observed-place parameters in AOPRMS may
be computed by means of the <a href="sla.html#.aoppa">sla.aoppa</a> routine. If nothing has
changed significantly except the time, the <a href="sla.html#.aoppat">sla.aoppat</a> routine may
be used to perform the requisite partial recomputation of AOPRMS.</li>
<li>At zenith distances beyond about 76°, the need for special care with the
corrections for refraction causes a marked increase in execution time.
Moreover, the effect gets worse with increasing zenith distance. Adroit
programming in the calling application may allow the problem to be
reduced. Prepare an alternative AOPRMS array, computed for zero
air-pressure; this will disable the refraction corrections and cause
rapid execution. Using this AOPRMS array, a preliminary call to the
present routine will, depending on the application, produce a rough
position which may be enough to establish whether the full, slow
calculation (using the real AOPRMS array) is worthwhile. For example,
there would be no need for the full calculation if the preliminary call
had already established that the source was well below the elevation
limits for a particular telescope.</li>
<li>The azimuths etc. used by the present routine are with respect to the
celestial pole. Corrections to the terrestrial pole can be computed using
<a href="sla.html#.polmo">sla.polmo</a>.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rap</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Geocentric apparent α (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dap</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Geocentric appanret δ (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aoprms</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>Star-independent apparent-to-observed parameters:</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line440">line 440</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss10.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss10.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] aob - observed azimuth (radians)
[1] zob - observed zenith distance (radians)
[2] hob - observed Hour Angle (radians)
[3] dob - observed Declination (radians)
[4] rob - observed Right Ascension (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".atmdsp"><span class="type-signature">(static) </span>atmdsp<span class="signature">(tdk, pmb, rh, wl1, a1, b1, wl2)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Atmospheric Dispersion</strong></p></p>
    



<div class="description">
    <p>Apply atmospheric-dispersion adjustments to refraction
coefficients.</p>
<ol>
<li>
<p>To use this routine, first call <a href="sla.html#.refco">sla.refco</a> specifying WL1 as the
wavelength. This yields refraction coefficients A1, B1, correct for that
wavelength. Subsequently, calls to <a href="sla.html#.atmdsp">sla.atmdsp</a> specifying different
wavelengths will produce new, slightly adjusted refraction coefficients
A2, B2, which apply to the specified wavelength.</p>
</li>
<li>
<p>Most of the atmospheric dispersion happens between 0.7μm and the UV
atmospheric cutoff, and the effect increases strongly towards the UV end.
For this reason a blue reference wavelength is recommended, for example
0.4μm.</p>
</li>
<li>
<p>The accuracy, for this set of conditions:</p>
<pre><code>height above sea level | 2000 m
              latitude | 29°
              pressure | 793 mb
           temperature | 290 K
              humidity | 0.5 (50%)
            lapse rate | 0.0065 K/m
  reference wavelength | 0.4 μm
        star elevation | 15°
</code></pre>
<p>is about 2.5 mas RMS between 0.3 and 1.0μm, and stays within 4 mas for
the whole range longward of 0.3μm (compared with a total dispersion from
0.3 to 20μm of about 11′′). These errors are typical for ordinary
conditions; in extreme conditions values a few times this size may occur.</p>
</li>
<li>
<p>If either wavelength exceeds 100μm, the radio case is assumed and the
returned refraction coefficients are the same as the given ones. Note that
radio refraction coefficients cannot be turned into optical values using
this routine, nor vice versa.</p>
</li>
<li>
<p>The algorithm consists of calculation of the refractivity of the air at
the observer for the two wavelengths, using the methods of the
<a href="sla.html#.refro">sla.refro</a> routine, and then scaling of the two refraction
coefficients according to classical refraction theory. This amounts to
scaling the A coefficient in proportion to (μ−1) and the B coefficient
almost in the same ratio (see R.M.Green, <em>Spherical Astronomy</em>, Cambridge
University Press, 1985).</p>
</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tdk</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>ambient temperature at the observer (K)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>pressure at the observer (mb)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>relative humidity at the observer (range 0-1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>base wavelength (um)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>a1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>refraction coefficient A for wavelength WL1 (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>b1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>refraction coefficient B for wavelength WL1 (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl2</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>wavelength for which adjusted A,B required (um)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line574">line 574</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss11.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss11.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a2 - refraction coefficient A for wavelength WL2 (radians)
b2 - refraction coefficient B for wavelength WL2 (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".atms"><span class="type-signature">(static) </span>atms<span class="signature">()</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Internal routine used by REFRO</strong></p></p>
    



<div class="description">
    <p>Refractive index and derivative with respect to height for the
stratosphere.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3646">line 3646</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] Refractive index at R
[1] R * rate the refractive index is changing at R</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".atmt"><span class="type-signature">(static) </span>atmt<span class="signature">()</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Internal routine used by REFRO</strong></p></p>
    



<div class="description">
    <p>Refractive index and derivative with respect to height for the
troposphere.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3627">line 3627</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] Temperature at R (K)
[1] Refractive index at R
[2] R * rate the refractive index is changing at R</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".cldj"><span class="type-signature">(static) </span>cldj<span class="signature">(iy, im, id)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Calendar to MJD</strong></p></p>
    



<div class="description">
    <p>Gregorian Calendar to Modified Julian Date.</p>
<ol>
<li>When an invalid year or month is supplied (status J = 1 or 2) the MJD
is <em>not</em> computed. When an invalid day is supplied (status J = 3)
the MJD <em>is</em> computed.</li>
<li>The year must be -4699 (i.e. 4700BC) or later. For year nBC use
IY = -(n-1).</li>
<li>An alternative to the present routine is sla_CALDJ, which accepts a year
with the century missing.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>The algorithm is adapted from Hatcher, <em>Q. Jl. R. astr. Soc.</em> (1984) 25,
53-55.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>iy</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Year in Gregorian calendar (-4699 or later)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>im</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Month in Gregorian calendar (1 to 12)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Day in Gregorian calendar (1 to 28-31)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line645">line 645</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss20.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss20.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If the year, month, or day are out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Modified Julian Date (JD-2400000.5) for 0h</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".daf2r"><span class="type-signature">(static) </span>daf2r<span class="signature">(ideg, iamin, asec)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Deg,Arcmin,Arcsec to Radians</strong></p></p>
    



<div class="description">
    <p>Convert degrees, arcminutes, arcseconds to radians.</p>
<ol>
<li>The result is computed even if any of the range checks fail.</li>
<li>The sign must be dealt with outside this routine.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ideg</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Degrees</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>iamin</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Arcminutes</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>asec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Arcseconds</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1690">line 1690</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss29.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss29.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If degrees, arcminutes or arcseconds are out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Angle in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dat"><span class="type-signature">(static) </span>dat<span class="signature">(utc)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>TAI-UTC</strong></p></p>
    



<div class="description">
    <p>Increment to be applied to Coordinated Universal Time UTC to
give International Atomic Time TAI.</p>
<ol>
<li>The UTC is specified to be a date rather than a time to indicate that
care needs to be taken not to specify an instant which lies within a
leap second. Though in most cases UTC can include the fractional part,
correct behaviour on the day of a leap second can be guaranteed only up
to the end of the second 23h59m59s.</li>
<li>For epochs from 1961 January 1 onwards, the expressions from the file</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>utc</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Date as a modified JD (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line779">line 779</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss31.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss31.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>TAI-UTC in seconds</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dav2m"><span class="type-signature">(static) </span>dav2m<span class="signature">(axvec)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Rotation Matrix from Axial Vector</strong></p></p>
    



<div class="description">
    <p>Form the rotation matrix corresponding to a given axial vector.</p>
<ol>
<li>A rotation matrix describes a rotation about some arbitrary axis,
called the Euler axis. The <em>axial vector</em> supplied to this routine has
the same direction as the Euler axis, and its magnitude is the amount
of rotation in radians.</li>
<li>If AXVEC is null, the unit matrix is returned.</li>
<li>The reference frame rotates clockwise as seen looking along the axial
vector from the origin.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>axvec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>axial vector (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line925">line 925</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss32.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss32.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>3x3 rotation matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dc62s"><span class="type-signature">(static) </span>dc62s<span class="signature">(v)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Cartesian 6-Vector to Spherical</strong></p></p>
    



<div class="description">
    <p>Conversion of position &amp; velocity in Cartesian coordinates to
spherical coordinates.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>v</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>[x,y,z,\dot x,\dot y,\dot z]</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2176">line 2176</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss35.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss35.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a - longitude (radians)
b - latitude (radians)
r - radial coordinate
ad - longitude derivative (radians per unit time)
bd - latitude derivative (radians per unit time)
rd - radial derivative</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dcc2s"><span class="type-signature">(static) </span>dcc2s<span class="signature">(v)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Cartesian to Spherical</strong></p></p>
    



<div class="description">
    <p>Cartesian coordinates to spherical coordinates.</p>
<ol>
<li>The spherical coordinates are longitude (+ve anticlockwise looking from
the +ve latitude pole) and latitude. The Cartesian coordinates are right
handed, with the x-axis at zero longitude and latitude, and the z-axis
at the +ve latitude pole.</li>
<li>If V is null, zero A and B are returned.</li>
<li>At either pole, zero A is returned.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>v</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>[x,y,z] vector</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line963">line 963</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss36.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss36.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a,b - spherical coordinates in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dcs2c"><span class="type-signature">(static) </span>dcs2c<span class="signature">(a,b)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Spherical to Cartesian</strong></p></p>
    



<div class="description">
    <p>Spherical coordinates to Cartesian coordinates.</p>
<ul>
<li>The spherical coordinates are longitude (+ve anticlockwise looking from
the +ve latitude pole) and latitude. The Cartesian coordinates are right
handed, with the x-axis at zero longitude and latitude, and the z-axis at
the +ve latitude pole.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>a,b</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>spherical coordinates in radians: [α,δ] etc.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4719">line 4719</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss38.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss38.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[x,y,z] unit vector</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dd2tf"><span class="type-signature">(static) </span>dd2tf<span class="signature">(ndp, days)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Days to Hour,Min,Sec</strong></p></p>
    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ndp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Number of decimal places of seconds</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>days</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Interval in days</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1522">line 1522</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss39.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss39.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] sign, '+' or '-'
[1-4] degrees, arcminutes, arcseconds, fraction</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".de2h"><span class="type-signature">(static) </span>de2h<span class="signature">(ha, dec, phi)</span><span class="type-signature"> &rarr; {array}</span></h4>
    

    
    <p class="summary"><p><strong>h,δ to Az,El</strong></p></p>
    



<div class="description">
    <p>Equatorial to horizon coordinates.</p>
<ol>
<li>Azimuth is returned in the range 0−2π; north is zero, and east is +π/2.
Elevation is returned in the range ±π.</li>
<li>The latitude must be geodetic. In critical applications, corrections
for polar motion should be applied.</li>
<li>In some applications it will be important to specify the correct type
of hour angle and declination in order to produce the required type of
azimuth and elevation. In particular, it may be important to distinguish
between elevation as affected by refraction, which would require the
<em>observed</em> [h,δ], and the elevation <em>in vacuo</em>, which would require the
<em>topocentric</em> [h,δ]. If the effects of diurnal aberration can be
neglected, the <em>apparent</em> [h,δ] may be used instead of the topocentric
[h,δ].</li>
<li>No range checking of arguments is carried out.</li>
<li>In applications which involve many such calculations, rather than calling
the present routine it will be more efficient to use inline code, having
previously computed fixed terms such as sine and cosine of latitude, and
(for tracking a star) sine and cosine of declination.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ha</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hour Angle in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Declination in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observatory latitude in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1008">line 1008</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss40.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss40.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[az,el] - Azimuth and elevation in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".deuler"><span class="type-signature">(static) </span>deuler<span class="signature">(order, phi, theta, psi)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Euler Angles to Rotation Matrix</strong></p></p>
    



<div class="description">
    <p>Form a rotation matrix from the Euler angles - three successive
rotations about specified Cartesian axes.</p>
<ol>
<li>A rotation is positive when the reference frame rotates anticlockwise as
seen looking towards the origin from the positive region of the specified
axis.</li>
<li>The characters of ORDER define which axes the three successive rotations
are about. A typical value is ‘ZXZ’, indicating that RMAT is to become
the direction cosine matrix corresponding to rotations of the reference
frame through PHI radians about the old z-axis, followed by THETA radians
about the resulting x-axis, then PSI radians about the resulting z-axis.</li>
<li>The axis names can be any of the following, in any order or combination:
X, Y, Z, uppercase or lowercase, 1, 2, 3. Normal axis labelling/numbering
conventions apply; the xyz (≡123) triad is right-handed. Thus, the ‘ZXZ’
example given above could be written ‘zxz’ or ‘313’ (or even ‘ZxZ’ or
‘3xZ’). ORDER is terminated by length or by the first unrecognized
character. Fewer than three rotations are acceptable, in which case the
later angle arguments are ignored. Zero rotations produces the identity
RMAT.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>order</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Specifies about which axes the rotations occur</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>1st rotation (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>theta</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>2nd rotation (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>psi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>3rd rotation (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1059">line 1059</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss41.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss41.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Rotation matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dh2e"><span class="type-signature">(static) </span>dh2e<span class="signature">(az, el, phi)</span><span class="type-signature"> &rarr; {array}</span></h4>
    

    
    <p class="summary"><p><strong>Az,El to h,δ</strong></p></p>
    



<div class="description">
    <p>Horizon to equatorial coordinates.</p>
<ol>
<li>The sign convention for azimuth is north zero, east +π/2.</li>
<li>HA is returned in the range ±π. Declination is returned in the range ±π/2.</li>
<li>The latitude is (in principle) geodetic. In critical applications,
corrections for polar motion should be applied (see <a href="sla.html#.polmo">sla.polmo</a>).</li>
<li>In some applications it will be important to specify the correct type
of elevantion in order to produce the required type of [h,δ].
In particular, it may be important to distinguish between elevation as
affected by refraction, which will yield the <em>observed</em> [h,δ], and the
elevation <em>in vacuo</em>, which will yield the <em>topocentric</em> [h,δ]. If the
effects of diurnal aberration can be neglected, the topocentric [h,δ]
may be used instead of the <em>apparent</em> [h,δ].</li>
<li>No range checking of arguments is carried out.</li>
<li>In applications which involve many such calculations, rather than calling
the present routine it will be more efficient to use inline code, having
previously computed fixed terms such as sine and cosine of latitude.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>az</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Azimuth in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>el</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Elevation in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observatory latitude in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1153">line 1153</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss40.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss40.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[ha,dec] - Hour angle and declionation in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dimxv"><span class="type-signature">(static) </span>dimxv<span class="signature">(dm, va)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Apply 3D Reverse Rotation</strong></p></p>
    



<div class="description">
    <p>Multiply a 3-vector by the inverse of a rotation matrix.</p>
<ol>
<li>This routine performs the operation: <strong>b = M^T⋅a</strong> where <strong>a</strong> and <strong>b</strong>
are the 3-vectors VA and VB respectively, and <strong>M</strong> is the 3×3 matrix DM.</li>
<li>The main function of this routine is apply an inverse rotation; under
these circumstances, <strong>M</strong> is <em>orthogonal</em>, with its inverse the same as
its transpose.</li>
<li>To comply with the ANSI Fortran 77 standard, VA and VB must <em>not</em> be the
same array. The routine is, in fact, coded so as to work properly on
the VAX and many other systems even if this rule is violated, something
that is <em>not</em>, however, recommended.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>3x3 rotation matrix</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>va</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>vector to be rotated</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2149">line 2149</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss44.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss44.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>result vector</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".djcal"><span class="type-signature">(static) </span>djcal<span class="signature">(ndp, djm)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>MJD to Gregorian for Output</strong></p></p>
    



<div class="description">
    <p>Modified Julian Date to Gregorian Calendar Date, expressed in
a form convenient for formatting messages (namely rounded to
a specified precision, and with the fields stored in a single
array).</p>
<ol>
<li>Any date after 4701BC March 1 is accepted.</li>
<li>Large NDP values risk internal overflows. It is typically safe to use
up to NDP=4.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>The algorithm is adapted from Hatcher, <em>Q. Jl. R. astr. Soc.</em> (1984) 25,
53-55.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ndp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>number of decimal places of days in fraction</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>djm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>modified Julian Date (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line680">line 680</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss45.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss45.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If the MJD is out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>year, month, day, fraction in Gregorian calendar</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".djcl"><span class="type-signature">(static) </span>djcl<span class="signature">(djm)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>MJD to Year,Month,Day,Frac</strong></p></p>
    



<div class="description">
    <h2>Modified Julian Date to Gregorian year, month, day, and
fraction of a day.</h2>
<p>References:</p>
<ul>
<li>The algorithm is adapted from Hatcher, <em>Q. Jl. R. astr. Soc.</em> (1984) 25,
53-55.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>djm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>modified Julian Date (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line728">line 728</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss46.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss46.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If the MJD is out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>iy - year, im - month, id - day
fd - fraction of day</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dmoon"><span class="type-signature">(static) </span>dmoon<span class="signature">(date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Approx Moon Pos/Vel</strong></p></p>
    



<div class="description">
    <p>Approximate geocentric position and velocity of the Moon.</p>
<ol>
<li>This routine is a full implementation of the algorithm published by
Meeus (see reference).</li>
<li>Meeus quotes accuracies of 10′′ in longitude, 3′′ in latitude and
′′02 arcsec in HP (equivalent to about 20 km in distance).
JPL DE200 over the interval 1960-2025 gives RMS errors of ′′37 and 83
mas/hour in longitude, ′′23 arcsec and 48 mas/hour in latitude, 11 km
and 81 mm/s in distance. The maximum errors over the same interval are
18′′ and ′′050/hour in longitude, 11′′ and ′′024/hour in latitude, 40 km
and 0.29 m/s in distance.</li>
<li>The original algorithm is expressed in terms of the obsolete time scale
<em>Ephemeris Time</em>. Either TDB or TT can be used, but not UT without
incurring significant errors (30′′ at the present time) due to the Moon’s
′′05/s movement.</li>
<li>The algorithm is based on pre IAU 1976 standards. However, the result has
been moved onto the new (FK5) equinox, an adjustment which is in any case
much smaller than the intrinsic accuracy of the procedure.</li>
<li>Velocity is obtained by a complete analytical differentiation of the
Meeus model.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Meeus, <em>L’Astronomie</em>, June 1984, p. 348.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (loosely ET) as a Modified Julian Date
(JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1204">line 1204</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss49.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss49.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Moon [x,y,z,\dot x,\dot y,\dot z], mean equator and
equinox of date (AU, AU/s)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dmxm"><span class="type-signature">(static) </span>dmxm<span class="signature">(a, b)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Multiply 3x3 Matrices</strong></p></p>
    



<div class="description">
    <p>Product of two 3x3 matrices.</p>
<ul>
<li>To comply with the ANSI Fortran 77 standard, A, B and C must be different
arrays. However, the routine is coded so as to work properly on many
platforms even if this rule is violated, something that is not, however,
recommended.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>a</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>3x3 matrix A</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>b</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>3x3 matrix B</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3364">line 3364</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss50.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss50.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>3x3 matrix result: AxB</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dmxv"><span class="type-signature">(static) </span>dmxv<span class="signature">(dm, va)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Apply 3D Rotation</strong></p></p>
    



<div class="description">
    <p>Multiply a 3-vector by a rotation matrix.</p>
<ol>
<li>This routine performs the operation: <strong>b = M⋅a</strong> where <strong>a</strong> and <strong>b</strong>
are the 3-vectors VA and VB respectively, and <strong>M</strong> is the 3×3 matrix DM.</li>
<li>The main function of this routine is apply a rotation; under these
circumstances, <strong>M</strong> is a proper real orthogonal matrix.</li>
<li>To comply with the ANSI Fortran 77 standard, VA and VB must not be the
same array. The routine is, in fact, coded so as to work properly with
many Fortran compilers even if this rule is violated, something that is
<em>not</em>, however, recommended.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>3x3 rotation matrix</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>va</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>3-vector to be rotated</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1490">line 1490</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss51.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss51.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Result 3-vector.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dr2af"><span class="type-signature">(static) </span>dr2af<span class="signature">(ndp, angle)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Radians to Hour,Min,Sec,Frac</strong></p></p>
    



<div class="description">
    <p>Convert an angle in radians to degrees, minutes, seconds,
fraction.</p>
<ol>
<li>NDP less than zero is interpreted as zero.</li>
<li>The largest useful value for NDP is determined by the size of ANGLE, the
format of DOUBLE PRECISION floating-point numbers on the target machine,
and the risk of overflowing IDMSF(4). On some architectures, for ANGLE
up to 2π, the available floating-point precision corresponds roughly to
NDP=12. However, the practical limit is NDP=9, set by the capacity of a
typical 32-bit IDMSF(4).</li>
<li>The absolute value of ANGLE may exceed 2π. In cases where it does not,
it is up to the caller to test for and handle the case where ANGLE is
very nearly 2π and rounds up to 360∘, by testing for IDMSF(1)=360 and
setting IDMSF(1-4) to zero.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ndp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Number of decimal places of arcseconds</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>angle</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Angle in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1574">line 1574</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss53.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss53.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] sign, '+' or '-'
[1-4] degrees, arcminutes, arcseconds, fraction</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dr2tf"><span class="type-signature">(static) </span>dr2tf<span class="signature">(ndp, angle)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Radians to Hour,Min,Sec,Frac</strong></p></p>
    



<div class="description">
    <p>Convert an angle in radians to hours, minutes, seconds,
fraction.</p>
<ol>
<li>NDP less than zero is interpreted as zero.</li>
<li>The largest useful value for NDP is determined by the size of ANGLE, the
format of DOUBLE PRECISION floating-point numbers on the target machine,
and the risk of overflowing IHMSF(4). On some architectures, for ANGLE
up to 2π, the available floating-point precision corresponds roughly to
NDP=12. However, the practical limit is NDP=9, set by the capacity of a
typical 32-bit IHMSF(4).</li>
<li>The absolute value of ANGLE may exceed 2π. In cases where it does not,
it is up to the caller to test for and handle the case where ANGLE is
very nearly 2π and rounds up to 24 hours, by testing for IHMSF(1)=24 and
setting IHMSF(1-4) to zero.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ndp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Number of decimal places of seconds</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>angle</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Angle in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1603">line 1603</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss54.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss54.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] - sign, '+' or '-'
[1-4] - hours, minutes, seconds, fraction</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".drange"><span class="type-signature">(static) </span>drange<span class="signature">(angle)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Put Angle into Range ±π</strong></p></p>
    



<div class="description">
    <p>Normalize an angle into the range ±π.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>angle</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Angle in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1614">line 1614</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss55.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss55.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Angle expressed in the range ±π</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dranrm"><span class="type-signature">(static) </span>dranrm<span class="signature">(angle)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Put Angle into Range 0−2π</strong></p></p>
    



<div class="description">
    <p>Normalize angle into range 0−2π.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>angle</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Angle in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1629">line 1629</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss56.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss56.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Angle expressed in the range 0−2π</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".ds2c6"><span class="type-signature">(static) </span>ds2c6<span class="signature">(a, b, r, ad, bd, rd)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Spherical Pos/Vel to Cartesian</strong></p></p>
    



<div class="description">
    <p>Conversion of position &amp; velocity in spherical coordinates to
Cartesian coordinates.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>a</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>longitude (radians) - for example α</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>b</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>latitude (radians) - for example δ</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>r</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>radial coordinate</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ad</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>longitude derivative (radians per unit time)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>bd</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>latitude derivative (radians per unit time)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rd</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>radial derivative</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2109">line 2109</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss57.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss57.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[x,y,z,\dot x,\dot y,\dot z]</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dsep"><span class="type-signature">(static) </span>dsep<span class="signature">(a1,, a2,)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Angle Between 2 Points on Sphere</strong></p></p>
    



<div class="description">
    <p>Angle between two points on a sphere.</p>
<ol>
<li>The spherical coordinates are right ascension and declination, longitude
and latitude, etc., in radians.</li>
<li>The result is always positive.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>a1,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>b1 - spherical coordinates of one point (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>a2,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>b2 - spherical coordinates of the other point (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4988">line 4988</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss59.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss59.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>angle between [A1,B1] and [A2,B2] in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dsepv"><span class="type-signature">(static) </span>dsepv<span class="signature">(v1, v2)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Angle Between 2 Vectors</strong></p></p>
    



<div class="description">
    <p>Angle between two vectors.</p>
<ol>
<li>There is no requirement for either vector to be of unit length.</li>
<li>If either vector is null, zero is returned.</li>
<li>The result is always positive.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>v1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>first vector</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>v2</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>second vector</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4961">line 4961</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss60.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss60.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>angle between V1 and V2 in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dt"><span class="type-signature">(static) </span>dt<span class="signature">(epoch)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Approximate ET minus UT</strong></p></p>
    



<div class="description">
    <p>Estimate ΔT, the offset between dynamical time and Universal
Time, for a given historical epoch.</p>
<ol>
<li>Depending on the epoch, one of three parabolic approximations is used:
before AD 979      | Stephenson &amp; Morrison’s 390 BC to AD 948 model
AD 979 to AD 1708  | Stephenson &amp; Morrison’s AD 948 to AD 1600 model
after AD 1708      | McCarthy &amp; Babcock’s post-1650 model
The breakpoints are chosen to ensure continuity: they occur at places
where the adjacent models give the same answer as each other.</li>
<li>The accuracy is modest, with errors of up to 20s during the interval
since 1650, rising to perhaps 30m by 1000 BC. Comparatively accurate
values from AD 1600 are tabulated in the <em>Astronomical Almanac</em> (see
section K8 of the 1995 edition).</li>
<li>The use of DOUBLE PRECISION for both argument and result is simply for
compatibility with other SLALIB time routines.</li>
<li>The models used are based on a lunar tidal acceleration value of
′′-2600 per century.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Seidelmann, P.K. (ed), 1992. <em>Explanatory Supplement to the Astronomical
Almanac</em>, ISBN 0-935702-68-7. This contains references to the papers by
Stephenson &amp; Morrison and by McCarthy &amp; Babcock which describe the models
used here.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>epoch</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>(Julian) epoch (e.g. 1850D0)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3335">line 3335</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss61.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss61.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Approximate ET-UT (after 1984, TT-UT1) in seconds</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dtf2d"><span class="type-signature">(static) </span>dtf2d<span class="signature">(ihour, imin, sec)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Hour,Min,Sec to Days</strong></p></p>
    



<div class="description">
    <p>Convert hours, minutes, seconds to days.</p>
<ol>
<li>The result is computed even if any of the range checks fail.</li>
<li>The sign must be dealt with outside this routine.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ihour</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hours</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>imin</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Minutes</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Seconds</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1649">line 1649</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss62.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss62.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If hours, minutes or seconds are out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Interval in days</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dtf2r"><span class="type-signature">(static) </span>dtf2r<span class="signature">(ihour, imin, sec)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Hour,Min,Sec to Radians</strong></p></p>
    



<div class="description">
    <p>Convert hours, minutes, seconds to radians.</p>
<ol>
<li>The result is computed even if any of the range checks fail.</li>
<li>The sign must be dealt with outside this routine.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ihour</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hours</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>imin</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Minutes</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Seconds</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1673">line 1673</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss63.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss63.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Angle in radians</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dtt"><span class="type-signature">(static) </span>dtt<span class="signature">(utc)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>TT minus UTC</strong></p></p>
    



<div class="description">
    <p>Compute ΔTT, the increment to be applied to Coordinated
Universal Time UTC to give Terrestrial Time TT.</p>
<ol>
<li>The UTC is specified to be a date rather than a time to indicate that
care needs to be taken not to specify an instant which lies within a leap
second. Though in most cases UTC can include the fractional part, correct
behaviour on the day of a leap second can be guaranteed only up to the
end of the second 23h59m59s.</li>
<li>Pre 1972 January 1 a fixed value of 10 + ET−TAI is returned.</li>
<li>TT is one interpretation of the defunct time scale <em>Ephemeris Time</em>, ET.</li>
<li>See also the routine {sla.dt}, which roughly estimates ET−UT for
historical epochs.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>utc</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UTC date as a modified JD (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1722">line 1722</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss68.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss68.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>TT-UTC in seconds</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dvdv"><span class="type-signature">(static) </span>dvdv<span class="signature">(va, vb)</span><span class="type-signature"> &rarr; {Array(3)}</span></h4>
    

    
    <p class="summary"><p><strong>Scalar Product</strong></p></p>
    



<div class="description">
    <p>Scalar product of two 3-vectors.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>va</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array(3)</span>


            
            </td>

            

            

            <td class="description last"><p>first vector</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>vb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array(3)</span>


            
            </td>

            

            

            <td class="description last"><p>second vector</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4735">line 4735</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss70.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss70.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>scalar product VA.VB</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array(3)</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dvn"><span class="type-signature">(static) </span>dvn<span class="signature">(v)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Normalize Vector</strong></p></p>
    



<div class="description">
    <p>Normalize a 3-vector, also giving the modulus.</p>
<ul>
<li>If the modulus of V is zero, UV is set to zero as well.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>v</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>vector</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4448">line 4448</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss71.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss71.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>uv - unit vector in direction of V
vm - modulus of V</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".dvxv"><span class="type-signature">(static) </span>dvxv<span class="signature">(va, vb)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Vector product</strong></p></p>
    



<div class="description">
    <p>Vector product of two 3-vectors.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>va</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>first vector</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>vb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>second vector</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4941">line 4941</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss72.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss72.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>vector product VA x VB</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".ecmat"><span class="type-signature">(static) </span>ecmat<span class="signature">(date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Form α,δ -&gt; λ,β Matrix</strong></p></p>
    



<div class="description">
    <p>Form the equatorial to ecliptic rotation matrix (IAU 1980
theory).</p>
<ol>
<li>RMAT is matrix <strong>M</strong> in the expression <strong>v</strong>_ecl = <strong>M</strong>⋅<strong>v</strong>_equ.</li>
<li>The equator, equinox and ecliptic are mean of date.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as Modified Julian Date
(JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line5008">line 5008</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss76.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss76.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>3x3 rotation matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".el2ue"><span class="type-signature">(static) </span>el2ue<span class="signature">(date, jform, epoch, orbinc, anode, perih, aorq, e, aorl, dm)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Conventional to Universal Elements</strong></p></p>
    



<div class="description">
    <p>Transform conventional osculating orbital elements into
&quot;universal&quot; form.</p>
<ol>
<li>The “universal” elements are those which define the orbit for the
purposes of the method of universal variables (see reference). They
consist of the combined mass of the two bodies, an epoch, and the
position and velocity vectors (arbitrary reference frame) at that epoch.
The parameter set used here includes also various quantities that can,
in fact, be derived from the other information. This approach is taken
to avoiding unnecessary computation and loss of accuracy. The
supplementary quantities are (i) α, which is proportional to the total
energy of the orbit, (ii) the heliocentric distance at epoch, (iii) the
outwards component of the velocity at the given epoch, (iv) an estimate
of ψ, the “universal eccentric anomaly” at a given date and (v) that date.</li>
<li>The companion routine is <a href="sla.html#.ue2pv">sla.ue2pv</a>. This takes the set of numbers
that the present routine outputs and uses them to derive the object’s
position and velocity. A single prediction requires one call to the
present routine followed by one call to <a href="sla.html#.ue2pv">sla.ue2pv</a>; for
convenience, the two calls are packaged as the routine <a href="sla.html#.planel">sla.planel</a>.
Multiple predictions may be made by again calling the present routine
once, but then calling <a href="sla.html#.ue2pv">sla.ue2pv</a> multiple times, which is faster
than multiple calls to <a href="sla.html#.planel">sla.planel</a>.</li>
<li>DATE is the epoch of osculation. It is in the TT time scale (formerly
Ephemeris Time, ET) and is a Modified Julian Date (JD−2400000.5).</li>
<li>The supplied orbital elements are with respect to the J2000 ecliptic and
equinox. The position and velocity parameters returned in the array U
are with respect to the mean equator and equinox of epoch J2000, and
are for the perihelion prior to the specified epoch.</li>
<li>The universal elements returned in the array U are in canonical units
(solar masses, AU and canonical days).</li>
<li>Three different element-format options are supported, as follows.
<ul>
<li>JFORM=1, suitable for the major planets:</li>
<li>JFORM=2, suitable for minor planets:</li>
<li>JFORM=3, suitable for comets:</li>
</ul>
</li>
<li>Unused elements (DM for JFORM=2, AORL and DM for JFORM=3) are not
accessed.</li>
<li>The algorithm was originally adapted from the EPHSLA program of D.H.P.
Jones (private communication, 1996). The method is based on Stumpff’s
Universal Variables.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Everhart, E. &amp; Pitkin, E.T., <em>Am. J. Phys.</em> 51, 712, 1983.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Epoch (TT MJD) of osculation (Note 3)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>jform</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Choice of element set (1-3; Note 6)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>epoch</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Epoch of elements (t0 or T, TT MJD)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>orbinc</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Inclination (i, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>anode</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Longitude of the ascending node (Ω, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>perih</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Longitude or argument of perihelion (ϖ or ω, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aorq</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Mean distance or perihelion distance (a or q, AU)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>e</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Eccentricity (e)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aorl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Mean anomaly or longitude (M or L, radians,
JFORM=1,2 only)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Daily motion (n, radians, jform=1 only)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2590">line 2590</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss79.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss79.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If jform, e, aorq or dm are out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Universal orbital elements (Note 1)
[0] combined mass (M+m)
[1] total energy of the orbit (α)
[2] reference (osculating) epoch (t0)
[3-5] position at reference epoch (r0)
[6-8] velocity at reference epoch (v0)
[9] heliocentric distance at reference epoch
[10] r0.v0
[11] date (t)
[12] universal eccentric anomaly (ψ) of date, approx</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".epb2d"><span class="type-signature">(static) </span>epb2d<span class="signature">(epb)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p>Besselian Epoch to MJD.</p></p>
    



<div class="description">
    <h2>Conversion of Besselian epoch to Modified Julian Date.</h2>
<p>References:</p>
<ul>
<li>Lieske, J.H., 1979. <em>Astr.Astrophys.</em> 73, 282.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>epb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Besselian epoch</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1736">line 1736</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss81.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss81.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Modified Julian Date (JD - 2400000.5)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".epj"><span class="type-signature">(static) </span>epj<span class="signature">(date)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>MJD to Julian Epoch</strong></p></p>
    



<div class="description">
    <h2>Convert Modified Julian Date to Julian Epoch.</h2>
<p>References:</p>
<ul>
<li>Lieske, J.H., 1979. <em>Astr.Astrophys.</em>, 73, 282.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Modified Julian Date (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3395">line 3395</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss83.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss83.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Julian Epoch</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".eqecl"><span class="type-signature">(static) </span>eqecl<span class="signature">(dr,, date)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>J2000 RA, Dec to Ecliptic</strong></p></p>
    



<div class="description">
    <p>Transformation from J2000.0 equatorial coordinates to ecliptic
longitude and latitude.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dr,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>dd - J2000.0 mean [α,δ] (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as Modified Julian Date
(JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line5031">line 5031</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss86.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss86.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>dl, db - ecliptic longitude and latitude (mean of date,
IAU 1980 theory, radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".eqeqx"><span class="type-signature">(static) </span>eqeqx<span class="signature">(date)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Equation of the Equinoxes</strong></p></p>
    



<div class="description">
    <p>Equation of the equinoxes  (IAU 1994).</p>
<ol>
<li>The equation of the equinoxes is defined here as GAST-GMST: it is added
to a <em>mean</em> sidereal time to give the <em>apparent</em> sidereal time.</li>
<li>The change from the classic “textbook” expression Δψ cosϵ occurred with
IAU Resolution C7, Recommendation 3 (1994). The new formulation takes
into account cross-terms between the various precession and nutation
quantities, amounting to about 3 milliarcsec. The transition from the old
to the new model officially took place on 1997 February 27.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Capitaine, N. &amp; Gontier, A.-M. (1993), <em>Astron. Astrophys.</em>, 275, 645-650.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as Modified Julian Date
(JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1758">line 1758</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss87.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss87.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The equation of the equinoxes (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".evp"><span class="type-signature">(static) </span>evp<span class="signature">(date, deqx)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Earth Position &amp; Velocity</strong></p></p>
    



<div class="description">
    <p>Barycentric and heliocentric velocity and position of the Earth.</p>
<ol>
<li>This routine is accurate enough for many purposes but faster and more
compact than the sla.epv routine. The maximum deviations from the
JPL DE96 ephemeris are as follows:
<ul>
<li>velocity (barycentric or heliocentric): 420 mm/s</li>
<li>position (barycentric): 6900 km</li>
<li>position (heliocentric): 1600 km</li>
</ul>
</li>
<li>The routine is adapted from the BARVEL and BARCOR subroutines of Stumpff
(1980). Most of the changes are merely cosmetic and do not affect the
results at all. However, some adjustments have been made so as to give
results that refer to the IAU 1976 ‘FK5’ equinox and precession, although
the differences these changes make relative to the results from Stumpff’s
original ‘FK4’ version are smaller than the inherent accuracy of the
algorithm. One minor shortcoming in the original routines that has <em>not</em>
been corrected is that slightly better numerical accuracy could be
achieved if the various polynomial evaluations were to be so arranged
that the smallest terms were computed first.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Stumpff, P., 1980., <em>Astron.Astrophys.Suppl.Ser.</em> 41, 1-8.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as a Modified Julian Date
(JD-2400000.5).</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>deqx</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Julian Epoch (e.g. 2000D0) of mean equator and
equinox of the vectors returned. If DEQX &lt;0, all
vectors are referred to the mean equator and equinox
(FK5) of date DATE.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4209">line 4209</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss91.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss91.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] dvb - barycentric [\dot x,\dot y,\dot z], AU/s
[1] dpb - barycentric [x,y,z], AU
[2] dvh - heliocentric [\dot x,\dot y,\dot z], AU/s
[3] dph - heliocentric [x,y,z], AU</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".fk45z"><span class="type-signature">(static) </span>fk45z<span class="signature">(r1950, d1950, epoch)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>FK4 to FK5, no P.M. or Parallax</strong></p></p>
    



<div class="description">
    <p>Convert B1950.0 FK4 star data to J2000.0 FK5 assuming zero
proper motion in the FK5 frame. This routine converts stars
from the old, Bessel-Newcomb, FK4 system to the new, IAU 1976,
FK5, Fricke system, in such a way that the FK5 proper motion is
zero. Because such a star has, in general, a non-zero proper
motion in the FK4 system, the routine requires the epoch at
which the position in the FK4 system was determined. The method
is from appendix 2 of reference 1, but using the constants of
reference 4.</p>
<ol>
<li>The epoch BEPOCH is strictly speaking Besselian, but if a Julian epoch
is supplied the result will be affected only to a negligible extent.</li>
<li>Conversion from Besselian epoch 1950.0 to Julian epoch 2000.0 only is
provided for. Conversions involving other epochs will require use of the
appropriate precession, proper motion, and E-terms routines before and/or
after <a href="sla.html#.fk45z">sla.fk45z</a> is called.</li>
<li>In the FK4 catalogue the proper motions of stars within 10∘ of the poles
do not include the <em>differential E-terms</em> effect and should, strictly
speaking, be handled in a different manner from stars outside these
regions. However, given the general lack of homogeneity of the star data
available for routine astrometry, the difficulties of handling positions
that may have been determined from astrometric fields spanning the polar
and non-polar regions, the likelihood that the differential E-terms
effect was not taken into account when allowing for proper motion in
past astrometry, and the undesirability of a discontinuity in the
algorithm, the decision has been made in this routine to include the
effect of differential E-terms on the proper motions for all stars,
whether polar or not. At epoch 2000, and measuring on the sky rather than
in terms of Δα, the errors resulting from this simplification are less
than 1 milliarcsecond in position and 1 milliarcsecond per century in
proper motion.</li>
<li>See also <a href="sla.html#.fk425">sla.fk425</a>, sla.fk524, sla.fk54z.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Aoki, S., et al., 1983. <em>Astr.Astrophys.</em>, 128, 263.</li>
<li>Smith, C.A. et al., 1989. <em>Astr.J.</em> 97, 265.</li>
<li>Yallop, B.D. et al., 1989. <em>Astr.J.</em> 97, 274.</li>
<li>Seidelmann, P.K. (ed), 1992. <em>Explanatory Supplement to the Astronomical
Almanac</em>, ISBN 0-935702-68-7.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>r1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 FK4 α at epoch BEPOCH (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>d1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 FK4 δ at epoch BEPOCH (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>epoch</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Besselian epoch (e.g. 1979.3D0)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1815">line 1815</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss94.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss94.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <ul>
<li>r2000 - J2000.0 FK5 α (radians)</li>
<li>d2000 - J2000.0 FK5 δ (radians)</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".fk52h"><span class="type-signature">(static) </span>fk52h<span class="signature">(r5, d5, dr5, dd5)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>FK5 to Hipparcos</strong></p></p>
    



<div class="description">
    <p>Transform an FK5 (J2000) position and proper motion into the
frame of the Hipparcos catalogue.</p>
<ol>
<li>
<p>The α proper motions are α̇  rather than α̇ cosδ, and are per year rather
than per century.</p>
</li>
<li>
<p>The FK5 to Hipparcos transformation consists of a pure rotation and spin;
zonal errors in the FK5 catalogue are not taken into account.</p>
</li>
<li>
<p>The adopted epoch J2000.0 FK5 to Hipparcos orientation and spin values
are as follows (see reference):</p>
<h2>| orientation | spin</h2>
<p>x | -19.9       | -0.30
y |  -9.1       | +0.60
z | +22.9       | +0.70
| mas         | mas/y</p>
<p>These orientation and spin components are interpreted as axial vectors.
An axial vector points at the pole of the rotation and its length is the
amount of rotation in radians.</p>
</li>
<li>
<p>See also sla.fk5hz, <a href="sla.html#.h2fk5">sla.h2fk5</a>, sla.hfk5z.</p>
</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Feissel, M. &amp; Mignard, F., 1998., <em>Astron.Astrophys.</em> 331, L33-L36.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>r5</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>J2000.0 FK5 α (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>d5</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>J2000.0 FK5 δ (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dr5</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>J2000.0 FK5 proper motion in α (radians per Julian
year)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dd5</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>J2000.0 FK5 proper motion in δ (radians per Julian
year)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2279">line 2279</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss96.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss96.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>rh - Hipparcos α (radians)
dh - Hipparcos δ (radians)
drh - Hipparcos proper motion in α (radians per Julian
year)
ddh - Hipparcos proper motion in δ (radians per Julian
year)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".fk425"><span class="type-signature">(static) </span>fk425<span class="signature">(r1950, d1950, dr1950, dd1950, p1950, v1950)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>FK4 to FK5.</strong></p></p>
    



<div class="description">
    <p>Convert B1950.0 FK4 star data to J2000.0 FK5. This routine
converts stars from the old, Bessel-Newcomb, FK4 system to the
new, IAU 1976, FK5, Fricke system. The precepts of Smith et al.
(see reference 1) are followed, using the implementation by
Yallop et al. (reference 2) of a matrix method due to Standish.
Kinoshita’s development of Andoyer’s post-Newcomb precession is
used. The numerical constants from Seidelmann et al. (reference
3) are used canonically.</p>
<ol>
<li>The α proper motions are α̇  rather than α̇ cosδ, and are per year rather
than per century.</li>
<li>Conversion from Besselian epoch 1950.0 to Julian epoch 2000.0 only is
provided for. Conversions involving other epochs will require use of the
appropriate precession, proper motion, and E-terms routines before and/or
after <a href="sla.html#.fk425">sla.fk425</a> is called.</li>
<li>In the FK4 catalogue the proper motions of stars within 10∘ of the poles
do not include the <em>differential E-terms</em> effect and should, strictly
speaking, be handled in a different manner from stars outside these
regions. However, given the general lack of homogeneity of the star data
available for routine astrometry, the difficulties of handling positions
that may have been determined from astrometric fields spanning the polar
and non-polar regions, the likelihood that the differential E-terms
effect was not taken into account when allowing for proper motion in past
astrometry, and the undesirability of a discontinuity in the algorithm,
the decision has been made in this routine to include the effect of
differential E-terms on the proper motions for all stars, whether polar
or not. At epoch J2000, and measuring on the sky rather than in terms of
Δα, the errors resulting from this simplification are less than 1
milliarcsecond in position and 1 milliarcsecond per century in proper
motion.</li>
<li>See also <a href="sla.html#.fk45z">sla.fk45z</a>, sla.fk524, sla.fk54z.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Smith, C.A. et al., 1989. <em>Astr.J.</em> 97, 265.</li>
<li>Yallop, B.D. et al., 1989. <em>Astr.J.</em> 97, 274.</li>
<li>Seidelmann, P.K. (ed), 1992. <em>Explanatory Supplement to the Astronomical
Almanac</em>, ISBN 0-935702-68-7.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>r1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 α (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>d1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 δ (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dr1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 proper motion in α (radians per tropical
year)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dd1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 proper motion in δ (radians per tropical
year)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>p1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 parallax (arcsec)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>v1950</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>B1950.0 radial velocity (km/s, +ve = moving away)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line1913">line 1913</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss93.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss93.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <ul>
<li>r2000 - J2000.0 α (radians)</li>
<li>d2000 - J2000.0 δ (radians)</li>
<li>dr2000 - J2000.0 proper motion in α (radians per Julian year)</li>
<li>dd2000 - J2000.0 proper motion in δ (radians per Julian year)</li>
<li>p2000 - J2000.0 parallax (arcsec)</li>
<li>v2000 - J2000.0 radial velocity (km/s, +ve = moving away)</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".geoc"><span class="type-signature">(static) </span>geoc<span class="signature">(p, h)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Geodetic to Geocentric</strong></p></p>
    



<div class="description">
    <p>Convert geodetic position to geocentric.</p>
<ol>
<li>Geocentric latitude can be obtained by evaluating ATAN2(Z,R).</li>
<li>IAU 1976 constants are used.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>p</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Latitude (geodetic, radians).</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>h</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Height above reference spheroid (geodetic, metres).</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2085">line 2085</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss103.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss103.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] Distance from Earth axis (AU)
[1] Distance from plane of Earth equator (AU)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".gmst"><span class="type-signature">(static) </span>gmst<span class="signature">(ut1)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>UT to GMST</strong></p></p>
    



<div class="description">
    <p>Conversion from universal time UT1 to Greenwich mean sidereal
time.</p>
<ol>
<li>The IAU 1982 expression (see page S15 of the 1984 <em>Astronomical Almanac</em>)
is used, but rearranged to reduce rounding errors. This expression is
always described as giving the GMST at 0hUT; in fact, it gives the
difference between the GMST and the UT, which happens to equal the GMST
(modulo 24 hours) at 0hUT each day. In <a href="sla.html#.gmst">sla.gmst</a>, the entire UT
is used directly as the argument for the canonical formula, and the
fractional part of the UT is added separately; note that the factor
1.0027379⋯ does not appear.</li>
<li>See also the routine <a href="sla.html#.gmsta">sla.gmsta</a>, which delivers better numerical
precision by accepting the UT date and time as separate arguments.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ut1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Universal time (strictly UT1) expressed as modified
Julian Date (JD-2400000.5).</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2029">line 2029</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss104.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss104.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Greenwich mean sidereal time (radians).</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".gmsta"><span class="type-signature">(static) </span>gmsta<span class="signature">(date, ut)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>UT to GMST (extra precision)</strong></p></p>
    



<div class="description">
    <p>Conversion from Universal Time to Greenwich mean sidereal time,
with rounding errors minimized.</p>
<ol>
<li>The algorithm is derived from the IAU 1982 expression (see page S15 of
the 1984 <em>Astronomical Almanac</em>).</li>
<li>There is no restriction on how the UT is apportioned between the DATE
and UT1 arguments. Either of the two arguments could, for example, be
zero and the entire date + time supplied in the other. However, the
routine is designed to deliver maximum accuracy when the DATE argument
is a whole number and the UT1 argument lies in the range [0,1], or vice
versa.</li>
<li>See also the routine <a href="sla.html#.gmst">sla.gmst</a>, which accepts the UT1 as a single
argument. Compared with <a href="sla.html#.gmst">sla.gmst</a>, the extra numerical precision
delivered by the present routine is unlikely to be important in an
absolute sense, but may be useful when critically comparing algorithms
and in applications where two sidereal times close together are
differenced.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UT1 date as Modified Julian Date (integer part of
JD-2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ut</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>UT1 time (fraction of a day)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2059">line 2059</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss105.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss105.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Greenwich mean sidereal time (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".h2fk5"><span class="type-signature">(static) </span>h2fk5<span class="signature">(rh, dh, drh, ddh)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Hipparcos to FK</strong></p></p>
    



<div class="description">
    <p>Transform a Hipparcos star position and proper motion into the
FK5 (J2000) frame.</p>
<ol>
<li>
<p>The α proper motions are α̇  rather than α̇ cosδ, and are per year rather
than per century.</p>
</li>
<li>
<p>The FK5 to Hipparcos transformation consists of a pure rotation and spin;
zonal errors in the FK5 catalogue are not taken into account.</p>
</li>
<li>
<p>The adopted epoch J2000.0 FK5 to Hipparcos orientation and spin values
are as follows (see reference):</p>
<h2>| orientation | spin</h2>
<p>x | -19.9       | -0.30
y |  -9.1       | +0.60
z | +22.9       | +0.70
| mas         | mas/y</p>
<p>These orientation and spin components are interpreted as axial vectors.
An axial vector points at the pole of the rotation and its length is the
amount of rotation in radians.</p>
</li>
<li>
<p>See also <a href="sla.html#.fk52h">sla.fk52h</a>, sla.fk5hz, sla.hfk5z.</p>
</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Feissel, M. &amp; Mignard, F., 1998., <em>Astron.Astrophys.</em> 331, L33-L36.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hipparcos α (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hipparcos δ (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>drh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hipparcos proper motion in α (radians per Julian year)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ddh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hipparcos proper motion in δ (radians per Julian year)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2349">line 2349</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss108.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss108.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>r5 - J2000.0 FK5 α (radians)
d5 - J2000.0 FK5 δ (radians)
dr5 - J2000.0 FK5 proper motion in α (radians per Julian
year)
dd5 - J2000.0 FK5 proper motion in δ (radians per Julian
year)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".map"><span class="type-signature">(static) </span>map<span class="signature">(rm,, pr, pd, rv, eq, date)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Mean to Apparent</strong></p></p>
    



<div class="description">
    <p>Transform star [α,δ] from mean place to geocentric apparent.
The reference frames and time scales used are post IAU 1976.</p>
<ol>
<li>EQ is the Julian epoch specifying both the reference frame and the epoch
of the position – usually 2000. For positions where the epoch and equinox
are different, use the routine sla.pm to apply proper motion
corrections before using this routine.</li>
<li>The distinction between the required TDB and TT is always negligible.
Moreover, for all but the most critical applications UTC is adequate.</li>
<li>The α proper motions are α̇  rather than α̇ cosδ, and are per year rather
than per century.</li>
<li>This routine may be wasteful for some applications because it recomputes
the Earth position/velocity and the precession-nutation matrix each time,
and because it allows for parallax and proper motion. Where multiple
transformations are to be carried out for one epoch, a faster method is
to call the <a href="sla.html#.mappa">sla.mappa</a> routine once and then either the
<a href="sla.html#.mapqk">sla.mapqk</a> routine (which includes parallax and proper motion) or
<a href="sla.html#.mapqkz">sla.mapqkz</a> (which assumes zero parallax and FK5 proper motion).</li>
<li>The accuracy, starting from ICRS star data, is limited to about 1 mas by
the precession-nutation model used, SF2001. A different
precession-nutation model can be introduced by using <a href="sla.html#.mappa">sla.mappa</a>
and <a href="sla.html#.mapqk">sla.mapqk</a> (see the previous note) and replacing the
precession-nutation matrix into the parameter array directly.</li>
<li>The accuracy is further limited by the routine <a href="sla.html#.evp">sla.evp</a>, called by
<a href="sla.html#.mappa">sla.mappa</a>, which computes the Earth position and velocity using
the methods of Stumpff. The maximum error is about 0.3 milliarcsecond.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>1984 <em>Astronomical Almanac</em>, pp B39-B41.</li>
<li>Lederle &amp; Schwan, 1984. <em>Astr.Astrophys.</em>, 134, 1-6.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rm,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>dm - mean [α,δ] (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>proper motions: [α,δ] changes per Julian year</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pd</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>parallax (arcsec)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rv</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>radial velocity (km/s, +ve if receding)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>eq</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>epoch and equinox of star data (Julian)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB for apparent place (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4587">line 4587</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss115.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss115.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>ra,da - apparent [α,δ] (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".mappa"><span class="type-signature">(static) </span>mappa<span class="signature">(eq, date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Mean to Apparent Parameters</strong></p></p>
    



<div class="description">
    <p>Compute star-independent parameters in preparation for
conversions between mean place and geocentric apparent place.
The parameters produced by this routine are required in the
parallax, light deflection, aberration, and precession-nutation
parts of the mean/apparent transformations. The reference
frames and time scales used are post IAU 1976.</p>
<ol>
<li>For DATE, the distinction between the required TDB and TT is always
negligible. Moreover, for all but the most critical applications UTC is
adequate.</li>
<li>The vectors AMPRMS(2-4) and AMPRMS(5-7) are (in essence) referred to the
mean equinox and equator of epoch EQ. For EQ=2000D0, they are referred to
the ICRS.</li>
<li>The parameters produced by this routine are used by <a href="sla.html#.mapqk">sla.mapqk</a>,
<a href="sla.html#.mapqkz">sla.mapqkz</a> and sla.ampqk.</li>
<li>The accuracy, starting from ICRS star data, is limited to about 1 mas by
the precession-nutation model used, SF2001. A different
precession-nutation model can be introduced by first calling the present
routine and then replacing the precession-nutation matrix in
AMPRMS(13-21) directly.</li>
<li>A further limit to the accuracy of routines using the parameter array
AMPRMS is imposed by the routine <a href="sla.html#.evp">sla.evp</a>, used here to compute
the Earth position and velocity by the methods of Stumpff. The maximum
error in the resulting aberration corrections is about 0.3
milliarcsecond.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>1984 <em>Astronomical Almanac</em>, pp B39-B41.</li>
<li>Lederle &amp; Schwan, 1984. <em>Astr.Astrophys.</em> 134, 1-6.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>eq</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Epoch of mean equinox to be used (Julian)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4511">line 4511</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss116.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss116.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Star-independent mean-to-apparent parameters:
[0] time interval for proper motion (Julian years)
[1-3] barycentric position of the Earth (AU)
[4-6] heliocentric direction of the Earth (unit vector)
[7] (gravitational radius of Sun)x2/(Sun-Earth distance)
[8-10] v: barycentric Earth velocity in units of c
[11] \sqrt{1-|v|^2}
[12-20] precession-nutation 3x3 matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".mapqk"><span class="type-signature">(static) </span>mapqk<span class="signature">(rm,, pr,, px, rv, amprms)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Quick Mean to Apparent</strong></p></p>
    



<div class="description">
    <p>Quick mean to apparent place: transform a star RA,Dec from
mean place to geocentric apparent place, given the
star-independent parameters.</p>
<ol>
<li>Use of this routine is appropriate when efficiency is important and where
many star positions, all referred to the same equator and equinox, are to
be transformed for one epoch. The star-independent parameters can be
obtained by calling the <a href="sla.html#.mappa">sla.mappa</a> routine.</li>
<li>If the parallax and proper motions are zero the <a href="sla.html#.mapqkz">sla.mapqkz</a>
routine can be used instead.</li>
<li>The vectors AMPRMS(2-4) and AMPRMS(5-7) are (in essence) referred to the
mean equinox and equator of epoch EQ. For EQ=2000D0, they are referred to
the ICRS.</li>
<li>Strictly speaking, the routine is not valid for solar-system sources,
though the error will usually be extremely small. However, to prevent
gross errors in the case where the position of the Sun is specified, the
gravitational deflection term is restrained within about 920′′ of the
centre of the Sun’s disc. The term has a maximum value of about ′′185 at
this radius, and decreases to zero as the centre of the disc is
approached.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>1984 <em>Astronomical Almanac</em>, pp B39-B41.</li>
<li>Lederle &amp; Schwan, 1984. <em>Astr.Astrophys.</em> 134, 1-6.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rm,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>dm - mean [α,δ] (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pr,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>pd - proper motions: [α,δ] changes per Julian year</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>px</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>parallax (arcsec)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rv</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>radial velocity (km/s, +ve if receding)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>amprms</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>star-independent mean-to-apparent parameters:
[0] time interval for proper motion (Julian years)
[1-3] barycentric position of the Earth (AU)
[4-6] heliocentric direction of the Earth (unit vector)
[7] (gravitational radius of Sun)x2/(Sun-Earth distance)
[8-10] v: barycentric Earth velocity in units of c
[11] \sqrt{1-|v|^2}
[12-20] precession-nutation 3x3 matrix</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4866">line 4866</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss117.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss117.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>ra, da - apparent [α,δ] (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".mapqkz"><span class="type-signature">(static) </span>mapqkz<span class="signature">(rm,, amprms)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Quick Mean-Appt, no PM etc.</strong></p></p>
    



<div class="description">
    <p>Quick mean to apparent place: transform a star [α,δ] from
mean place to geocentric apparent place, given the
star-independent parameters, and assuming zero parallax and FK5
proper motion. The reference frames and time scales used are
post IAU 1976.</p>
<ol>
<li>Use of this routine is appropriate when efficiency is important and where
many star positions, all with parallax and proper motion either zero or
already allowed for, and all referred to the same equator and equinox,
are to be transformed for one epoch. The star-independent parameters can
be obtained by calling the <a href="sla.html#.mappa">sla.mappa</a> routine.</li>
<li>The corresponding routine for the case of non-zero parallax and FK5
proper motion is <a href="sla.html#.mapqk">sla.mapqk</a>.</li>
<li>The vectors AMPRMS(2-4) and AMPRMS(5-7) are (in essence) referred to the
mean equinox and equator of epoch EQ. For EQ=2000D0, they are referred to
the ICRS.</li>
<li>Strictly speaking, the routine is not valid for solar-system sources,
though the error will usually be extremely small. However, to prevent
gross errors in the case where the position of the Sun is specified, the
gravitational deflection term is restrained within about 920′′ of the
centre of the Sun’s disc. The term has a maximum value of about ′′185 at
this radius, and decreases to zero as the centre of the disc is
approached.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>1984 <em>Astronomical Almanac</em>, pp B39-B41.</li>
<li>Lederle &amp; Schwan, 1984. <em>Astr.Astrophys.</em> 134, 1-6.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>rm,</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>dm - mean [α,δ] (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>amprms</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>star-independent mean-to-apparent parameters:
[0] time interval for proper motion (Julian years)
[1-3] barycentric position of the Earth (AU)
[4-6] heliocentric direction of the Earth (unit vector)
[7] (gravitational radius of Sun)x2/(Sun-Earth distance)
[8-10] v: barycentric Earth velocity in units of c
[11] \sqrt{1-|v|^2}
[12-20] precession-nutation 3x3 matrix</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4779">line 4779</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss118.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss118.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>ra, da - apparent [α,δ] (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".nut"><span class="type-signature">(static) </span>nut<span class="signature">(date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Nutation Matrix</strong></p></p>
    



<div class="description">
    <p>Form the matrix of nutation (SF2001 theory) for a given date.</p>
<ol>
<li>The matrix is in the sense:
<strong>v</strong>_true = <strong>M</strong>×<strong>v</strong>_mean
where <strong>v</strong>_true is the star vector relative to the true equator and
equinox of date, <strong>M</strong> is the 3×3 matrix rmatn and <strong>v</strong>_mean is the
star vector relative to the mean equator and equinox of date.</li>
<li>The matrix represents forced nutation (but not free core nutation) plus
corrections to the IAU 1976 precession model.</li>
<li>Earth attitude predictions made by combining the present nutation matrix
with IAU 1976 precession are accurate to 1 mas (with respect to the ICRS)
for a few decades around 2000.</li>
<li>The distinction between the required TDB and TT is always negligible.
Moreover, for all but the most critical applications UTC is adequate.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Kaplan, G.H., 1981. <em>USNO circular No. 163</em>, p. A3-6.</li>
<li>Shirai, T. &amp; Fukushima, T., 2001, <em>Astron.J.</em>, 121, 3270-3283.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as Modified Julian Date
(JD-2400000.5).</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2409">line 2409</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss122.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss122.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>3x3 nutation matrix.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".nutc"><span class="type-signature">(static) </span>nutc<span class="signature">(date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Nutation Components</strong></p></p>
    



<div class="description">
    <p>Nutation (SF2001 theory): longitude &amp; obliquity components,
and mean obliquity.</p>
<ol>
<li>The routine predicts forced nutation (but not free core nutation) plus
corrections to the IAU 1976 precession model.</li>
<li>Earth attitude predictions made by combining the present nutation model
with IAU 1976 precession are accurate to 1 mas (with respect to the ICRS)
for a few decades around 2000.</li>
<li>The sla.nutc80 routine is the equivalent of the present routine
but using the IAU 1980 nutation theory. The older theory is less
accurate, leading to errors as large as 350 mas over the interval
1900-2100, mainly because of the error in the IAU 1976 precession.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Shirai, T. &amp; Fukushima, T., Astron.J. 121, 3270-3283 (2001).</li>
<li>Fukushima, T., Astron.Astrophys. 244, L11 (1991).</li>
<li>Simon, J. L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G.
&amp; Laskar, J., Astron.Astrophys. 282, 663 (1994).</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>TDB (formerly ET) as Modified Julian Date
(JD-2400000.5)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2440">line 2440</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss123.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss123.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] Nutation in longitude (radians)
[1] Nutation in obliquity (radians)
[2] Mean obliquity (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".performUnitTests"><span class="type-signature">(static) </span>performUnitTests<span class="signature">()</span><span class="type-signature"></span></h4>
    

    
    <p class="summary"><p>Perform all unit tests.</p></p>
    



<div class="description">
    <p>This is merely a wrapper for sla._performUnitTests,
which encloses the function call in a try..catch construct
and informs the user if anything goes wrong.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line5623">line 5623</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id=".performUnitTestsWrapped"><span class="type-signature">(static) </span>performUnitTestsWrapped<span class="signature">()</span><span class="type-signature"></span></h4>
    

    
    <p class="summary"><p>Perform all unit tests (wrapped function that does the work).</p></p>
    



<div class="description">
    <p>The values are taken from the original unit tests in SLALIB
(sla_test.f). The desired precision is typically the same,
although for some tests it can be lower by a few orders of
magnitude.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line5138">line 5138</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id=".planel"><span class="type-signature">(static) </span>planel<span class="signature">(date, jform, epoch, orbinc, anode, perih, aorq, e, aorl, dm)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Planet Position from Elements</strong></p></p>
    



<div class="description">
    <p>Heliocentric position and velocity of a planet, asteroid or
comet, starting from orbital elements.</p>
<ol>
<li>DATE is the instant for which the prediction is required. It is in the
TT time scale (formerly Ephemeris Time, ET) and is a Modified Julian
Date (JD−2400000.5).</li>
<li>The elements are with respect to the J2000 ecliptic and equinox.</li>
<li>A choice of three different element-format options is available,
as follows.
<ul>
<li>JFORM=1, suitable for the major planets:</li>
<li>JFORM=2, suitable for minor planets:</li>
<li>JFORM=3, suitable for comets:
Unused elements (DM for JFORM=2, AORL and DM for JFORM=3) are not
accessed.</li>
</ul>
</li>
<li>Each of the three element sets defines an unperturbed heliocentric orbit.
For a given epoch of observation, the position of the body in its orbit
can be predicted from these elements, which are called <em>osculating
elements</em>, using standard two-body analytical solutions. However, due to
planetary perturbations, a given set of osculating elements remains
usable for only as long as the unperturbed orbit that it describes is an
adequate approximation to reality. Attached to such a set of elements is
a date called the <em>osculating epoch</em>, at which the elements are,
momentarily, a perfect representation of the instantaneous position and
velocity of the body.
Therefore, for any given problem there are up to three different epochs
in play, and it is vital to distinguish clearly between them:
<ul>
<li>The epoch of observation: the moment in time for which the position of
the body is to be predicted.</li>
<li>The epoch defining the position of the body: the moment in time at
which, in the absence of purturbations, the specified position—mean
longitude, mean anomaly, or perihelion—is reached.</li>
<li>The osculating epoch: the moment in time at which the given elements
are correct.
For the major-planet and minor-planet cases it is usual to make the epoch
that defines the position of the body the same as the epoch of osculation.
Thus, only two different epochs are involved: the epoch of the elements
and the epoch of observation. For comets, the epoch of perihelion fixes
the position in the orbit and in general a different epoch of osculation
will be chosen. Thus, all three types of epoch are involved.
For the present routine:</li>
<li>The epoch of observation is the argument DATE.</li>
<li>The epoch defining the position of the body is the argument EPOCH.</li>
<li>The osculating epoch is not used and is assumed to be close enough to
the epoch of observation to deliver adequate accuracy. If not, a
preliminary call to sla.pertel may be used to update the
element-set (and its associated osculating epoch) by applying planetary
perturbations.</li>
</ul>
</li>
<li>The reference frame for the result is equatorial and is with respect to
the mean equinox and ecliptic of epoch J2000.</li>
<li>The algorithm was originally adapted from the EPHSLA program of D.H.P.
Jones (private communication, 1996). The method is based on Stumpff’s
Universal Variables.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Everhart, E. &amp; Pitkin, E.T., <em>Am. J. Phys.</em> 51, 712, 1983.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Epoch (TT MJD) of observation (JD-2400000.5, Note 1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>jform</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Choice of element set (1-3; Note 3)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>epoch</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Epoch of elements (t0 or T, TT MJD, Note 4)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>orbinc</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Inclination (i, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>anode</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Longitude of the ascending node (Ω, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>perih</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Longitude or argument of perihelion (ϖ or ω, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aorq</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Mean distance or perihelion distance (a or q, AU)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>e</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Eccentricity (e)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>aorl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Mean anomaly or longitude (M or L, radians,
JFORM=1,2 only)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Daily motion (n, radians, jform=1 only)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3029">line 3029</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss136.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss136.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Heliocentric [x,y,z,\dot x,\dot y,\dot z], equatorial,
J2000 (AU, AU/s)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".planet"><span class="type-signature">(static) </span>planet<span class="signature">(date, np)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Planetary Ephemerides</strong></p></p>
    



<div class="description">
    <p>Approximate heliocentric position and velocity of a planet.</p>
<ol>
<li>The epoch, DATE, is in the TDB time scale and is in the form of a
Modified Julian Date (JD−2400000.5).</li>
<li>The reference frame is equatorial and is with respect to the mean equinox
and ecliptic of epoch J2000.</li>
<li>If a planet number, NP, outside the range 1-9 is supplied, an error
status is returned (JSTAT = −1) and the PV vector is set to zeroes.</li>
<li>The algorithm for obtaining the mean elements of the planets from Mercury
to Neptune is due to J. L. Simon, P. Bretagnon, J. Chapront,
M. Chapront-Touze, G. Francou and J. Laskar (Bureau des Longitudes,
Paris, France). The (completely different) algorithm for calculating the
ecliptic coordinates of Pluto is by Meeus.</li>
<li>Comparisons of the present routine with the JPL DE200 ephemeris give the
following RMS errors over the interval 1960-2025:
| position (km) | speed (metre/sec)
Mercury | 334           | 0.437
Venus   | 1060          | 0.855
EMB     | 2010          | 0.815
Mars    | 7690          | 1.98
Jupiter | 71700         | 7.70
Saturn  | 199000        | 19.4
Uranus  | 564000        | 16.4
Neptune | 158000        | 14.4
Pluto   | 36400         | 0.137
From comparisons with DE102, Simon et al. quote the following longitude
accuracies over the interval 1800-2200:
Mercury | 4′′
Venus   | 5′′
EMB     | 6′′
Mars    | 17′′
Jupiter | 71′′
Saturn  | 81′′
Uranus  | 86′′
Neptune | 11′′
In the case of Pluto, Meeus quotes an accuracy of ′′06 in longitude and
′′02 in latitude for the period 1885-2099.
For all except Pluto, over the period 1000-3000, the accuracy is better
than 1.5 times that over 1800-2200. Outside the interval 1000-3000 the
accuracy declines. For Pluto the accuracy declines rapidly outside the
period 1885-2099. Outside these ranges (1885-2099 for Pluto, 1000-3000
for the rest) a “date out of range” warning status (JSTAT=+1) is
returned.</li>
<li>The algorithms for (i) Mercury through Neptune and (ii) Pluto are
completely independent. In the Mercury through Neptune case, the present
SLALIB implementation differs from the original Simon et al. Fortran code
in the following respects:
<ul>
<li>The date is supplied as a Modified Julian Date rather a Julian Date
MJD=(JD−2400000.5).</li>
<li>The result is returned only in equatorial Cartesian form; the ecliptic
longitude, latitude and radius vector are not returned.</li>
<li>The velocity is in AU per second, not AU per day.</li>
<li>Different error/warning status values are used.</li>
<li>Kepler’s Equation is not solved inline.</li>
<li>Polynomials in T are nested to minimize rounding errors.</li>
<li>Explicit double-precision constants are used to avoid mixed-mode
expressions.</li>
<li>There are other, cosmetic, changes to comply with Starlink/SLALIB style
guidelines.
None of the above changes affects the result significantly.</li>
</ul>
</li>
<li>For NP = 3 the result is for the Earth-Moon Barycentre. To obtain the
heliocentric position and velocity of the Earth, either use the SLALIB
routine <a href="sla.html#.evp">sla.evp</a> (or sla.epv) or call <a href="sla.html#.dmoon">sla.dmoon</a>
and subtract 0.012150581 times the geocentric Moon vector from the EMB
vector produced by the present routine. (The Moon vector should be
precessed to J2000 first, but this can be omitted for modern epochs
without introducing significant inaccuracy.)</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Simon et al., <em>Astron. Astrophys.</em> 282, 663 (1994).</li>
<li>Meeus, J., <em>Astronomical Algorithms</em>, Willmann-Bell (1991).</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Modified Julian Date (JD-2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>np</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Planet:
1 = Mercury
2 = Venus
3 = Earth-Moon Barycentre
4 = Mars
5 = Jupiter
6 = Saturn
7 = Uranus
8 = Neptune
9 = Pluto</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3123">line 3123</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss137.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss137.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If np or date are out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Heliocentric [x,y,z,\dot x,\dot y,\dot z], equatorial,
J2000 (AU, AU/s)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".polmo"><span class="type-signature">(static) </span>polmo<span class="signature">(elongm, phim, xp, yp)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    
    <p class="summary"><p><strong>Polar Motion</strong></p></p>
    



<div class="description">
    <p>Polar motion: correct site longitude and latitude for polar
motion and calculate azimuth difference between celestial and
terrestrial poles.</p>
<ol>
<li>“Mean” longitude and latitude are the (fixed) values for the site’s
location with respect to the IERS terrestrial reference frame; the
latitude is geodetic. TAKE CARE WITH THE LONGITUDE SIGN CONVENTION. The
longitudes used by the present routine are east-positive, in accordance
with geographical convention (and right-handed). In particular, note that
the longitudes returned by the sla.obs routine are west-positive,
following astronomical usage, and must be reversed in sign before use in
the present routine.</li>
<li>XP and YP are the (changing) coordinates of the Celestial Ephemeris Pole
with respect to the IERS Reference Pole. XP is positive along the
meridian at longitude 0∘, and YP is positive along the meridian at
longitude 270∘ (i.e. 90∘ west). Values for XP,YP can be obtained from
IERS circulars and equivalent publications; the maximum amplitude
observed so far is about ′′03.</li>
<li>“True” longitude and latitude are the (moving) values for the site’s
location with respect to the celestial ephemeris pole and the meridian
which corresponds to the Greenwich apparent sidereal time. The true
longitude and latitude link the terrestrial coordinates with the standard
celestial models (for precession, nutation, sidereal time etc).</li>
<li>The azimuths produced by <a href="sla.html#.aop">sla.aop</a> and <a href="sla.html#.aopqk">sla.aopqk</a> are with
respect to due north as defined by the Celestial Ephemeris Pole, and can
therefore be called “celestial azimuths”. However, a telescope fixed to
the Earth measures azimuth essentially with respect to due north as
defined by the IERS Reference Pole, and can therefore be called
“terrestrial azimuth”. Uncorrected, this would manifest itself as a
changing “azimuth zero-point error”. The value DAZ is the correction to
be added to a celestial azimuth to produce a terrestrial azimuth.</li>
<li>The present routine is rigorous. For most practical purposes, the
following simplified formulae provide an adequate approximation:
ELONG = ELONGM+XP<em>COS(ELONGM)-YP</em>SIN(ELONGM)
PHI   = PHIM+(XP<em>SIN(ELONGM)+YP</em>COS(ELONGM))<em>TAN(PHIM)
DAZ   = -SQRT(XP</em>XP+YP<em>YP)<em>COS(ELONGM-ATAN2(XP,YP))/COS(PHIM)
An alternative formulation for DAZ is:
X     = COS(ELONGM)<em>COS(PHIM)
Y     = SIN(ELONGM)<em>COS(PHIM)
DAZ   = ATAN2(-X</em>YP-Y</em>XP,X</em>X+Y</em>Y)</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Seidelmann, P.K. (ed), 1992. <em>Explanatory Supplement to the Astronomical
Almanac</em>, ISBN 0-935702-68-7, sections 3.27, 4.25, 4.52.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>elongm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>mean longitude of the site (radians, east +ve)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phim</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>mean geodetic latitude of the site (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>xp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>polar motion x-coordinate (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>yp</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>polar motion y-coordinate (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4648">line 4648</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss141.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss141.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>elong - true longitude of the site (radians, east +ve)
phi - true geodetic latitude of the site (radians)
daz - azimuth correction (terrestrial-celestial, radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".prec"><span class="type-signature">(static) </span>prec<span class="signature">(ep0, ep1)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Precession Matrix (FK5)</strong></p></p>
    



<div class="description">
    <p>Form the matrix of precession between two epochs (IAU 1976,
FK5).</p>
<ol>
<li>The epochs are TDB Julian epochs.</li>
<li>The matrix is in the sense:
<strong>v</strong>_1 = <strong>M</strong>⋅<strong>v</strong>_0
where <strong>v</strong>_1 is the star vector relative to the mean equator and equinox
of epoch EP1, <strong>M</strong> is the 3×3 matrix RMATP and <strong>v</strong>_0 is the star
vector relative to the mean equator and equinox of epoch EP0.</li>
<li>Though the matrix method itself is rigorous, the precession angles are
expressed through canonical polynomials which are valid only for a
limited time span. There are also known errors in the IAU precession rate.
The absolute accuracy of the present formulation is better than ′′01 from
1960 AD to 2040 AD, better than 1′′ from 1640 AD to 2360 AD, and remains
below 3′′ for the whole of the period 500 BC to 3000 AD. The errors
exceed 10′′ outside the range 1200 BC to 3900 AD, exceed 100′′ outside
4200 BC to 5600 AD and exceed 1000′′ outside 6800 BC to 8200 AD. The
SLALIB routine sla.precl implements a more elaborate model which
is suitable for problems spanning several thousand years.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Lieske, J.H., 1979. <em>Astr.Astrophys.</em> 73, 282; equations 6 &amp; 7, p283.</li>
<li>Kaplan, G.H., 1981. <em>USNO circular no. 163</em>, p. A2.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ep0</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>beginning epoch</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ep1</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>ending epoch</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3428">line 3428</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss143.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss143.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>3x3 precession matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".prenut"><span class="type-signature">(static) </span>prenut<span class="signature">(epoch, date)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Precession-Nutation Matrix</strong></p></p>
    



<div class="description">
    <p>Form the matrix of precession and nutation (SF2001).</p>
<ol>
<li>The epoch and date are TDB. TT (or even UTC) will do.</li>
<li>The matrix is in the sense:
<strong>v</strong>_true = <strong>M</strong>×<strong>v</strong>_mean
where <strong>v</strong>_true is the star vector relative to the true equator and
equinox of epoch DATE, <strong>M</strong> is the 3×3 matrix RMATPN and <strong>v</strong>_mean is
the star vector relative to the mean equator and equinox of epoch EPOCH.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>epoch</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Julian Epoch for mean coordinates</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Modified Julian Date (JD-2400000.5) for
true coordinates</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3455">line 3455</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss146.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss146.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Combined 3x3 precession-nutation matrix</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".pv2ue"><span class="type-signature">(static) </span>pv2ue<span class="signature">(pv, date, pmass)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Position/Velocity to Universal Elements</strong></p></p>
    



<div class="description">
    <p>Construct a universal element set based on an instantaneous
position and velocity.</p>
<ol>
<li>The PV 6-vector can be with respect to any chosen inertial frame, and
the resulting universal-element set will be with respect to the same
frame. A common choice will be mean equator and ecliptic of epoch J2000.</li>
<li>The mass, PMASS, is important only for the larger planets. For most
purposes (e.g. asteroids) use 0D0. Values less than zero are illegal.</li>
<li>The “universal” elements are those which define the orbit for the
purposes of the method of universal variables (see reference). They
consist of the combined mass of the two bodies, an epoch, and the
position and velocity vectors (arbitrary reference frame) at that epoch.
The parameter set used here includes also various quantities that can,
in fact, be derived from the other information. This approach is taken
to avoiding unnecessary computation and loss of accuracy. The
supplementary quantities are (i) α, which is proportional to the total
energy of the orbit, (ii) the heliocentric distance at epoch, (iii) the
outwards component of the velocity at the given epoch, (iv) an estimate
of ψ, the “universal eccentric anomaly” at a given date and (v) that date.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Everhart, E. &amp; Pitkin, E.T., <em>Am. J. Phys.</em> 51, 712, 1983.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>pv</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>Heliocentric [x,y,z,\dot x,\dot y,\dot z], equatorial,
J2000 (AU, AU/s; Note 1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Date (TT Modified Julian Date = JD-2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmass</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Mass of the planet (Sun = 1; Note 2)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2914">line 2914</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss148.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss148.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If pmass is negative, or r or v are too small.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>u - Universal orbital elements (Note 3)
[0] combined mass (M+m)
[1] total energy of the orbit (α)
[2] reference (osculating) epoch (t0)
[3-5] position at reference epoch (r0)
[6-8] velocity at reference epoch (v0)
[9] heliocentric distance at reference epoch
[10] r0.v0
[11] date (t)
[12] universal eccentric anomaly (ψ) of date, approx</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".pvobs"><span class="type-signature">(static) </span>pvobs<span class="signature">(p, h, stl)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Observatory Position &amp; Velocity.</strong></p></p>
    



<div class="description">
    <p>Position and velocity of an observing station.</p>
<ul>
<li>IAU 1976 constants are used.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>p</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Latitude (geodetic, radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>h</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Height above reference spheroid (geodetic, metres)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>stl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Local apparent sidereal time (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3292">line 3292</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss149.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss149.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[x,y,z,\dot x,\dot y,\dot z] (AU, AU/s, true equator
and equinox of date)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".rdplan"><span class="type-signature">(static) </span>rdplan<span class="signature">(date, np, elong, phi)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Apparent [α,δ] of Planet</strong></p></p>
    



<div class="description">
    <p>Approximate topocentric apparent [α,δ] and angular size of
a planet.</p>
<ol>
<li>The date is in a dynamical time scale (TDB, formerly ET) and is in the
form of a Modified Julian Date (JD−2400000.5). For all practical
purposes, TT can be used instead of TDB, and for many applications UT
will do (except for the Moon).</li>
<li>The longitude and latitude allow correction for geocentric parallax. This
is a major effect for the Moon, but in the context of the limited
accuracy of the present routine its effect on planetary positions is
small (negligible for the outer planets). Geocentric positions can be
generated by appropriate use of the routines <a href="sla.html#.dmoon">sla.dmoon</a> and
<a href="sla.html#.planet">sla.planet</a>.</li>
<li>The direction accuracy (arcsec, 1000-3000 AD) is of order:
Sun     | 5
Mercury | 2
Venus   | 10
Moon    | 30
Mars    | 50
Jupiter | 90
Saturn  | 90
Uranus  | 90
Neptune | 10
Pluto   | 1 (1885-2099 AD only)
The angular diameter accuracy is about 0.4% for the Moon, and 0.01% or
better for the Sun and planets. For more information on accuracy, refer
to the routines <a href="sla.html#.planet">sla.planet</a> and <a href="sla.html#.dmoon">sla.dmoon</a>, which the
present routine uses.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>MJD of observation (JD-2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>np</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Planet:
1 = Mercury
2 = Venus
3 = Moon
4 = Mars
5 = Jupiter
6 = Saturn
7 = Uranus
8 = Neptune
9 = Pluto
else = Sun</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>elong</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observer's longitude (east +ve) (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observer's latitude (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3507">line 3507</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss155.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss155.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If np is out of range.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0-1] topocentric apparent [α,δ] (radians)
[2] angular diameter (equatorial, radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".refco"><span class="type-signature">(static) </span>refco<span class="signature">(hm, tdk, pmb, rh, wl, phi, tlr, eps)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Refraction Constants</strong></p></p>
    



<div class="description">
    <p>Determine the constants a and b in the atmospheric refraction
model Δζ=a\tan ζ+b\tan^3 ζ, where ζ is the observed
zenith distance (i.e. affected by refraction) and Δζ is what
to add to ζ to give the topocentric (i.e. in vacuo) zenith
distance.</p>
<ol>
<li>Suggested values for the TLR and EPS arguments are 0.0065D0 and 1D−8
respectively. The signs of both are immaterial.</li>
<li>The radio refraction is chosen by specifying WL &gt;100 μm.</li>
<li>The routine is a slower but more accurate alternative to the
sla.refcoq routine. The constants it produces give perfect
agreement with <a href="sla.html#.refro">sla.refro</a> at zenith distances tan−11 (45∘) and
tan−14 (∼76∘). At other zenith distances, the model achieves:
′′05 accuracy for ζ&lt;80∘, ′′001 accuracy for ζ&lt;60∘, and
′′0001 accuracy for ζ&lt;45∘.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>hm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Height of the observer above sea level (metre)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tdk</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Ambient temperature at the observer K)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Pressure at the observer (mb)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Relative humidity at the observer (range 0-1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Effective wavelength of the source (microns)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Latitude of the observer (radian, astronomical)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tlr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Temperature lapse rate in the troposphere (K per metre)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>eps</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Precision required to terminate iteration (radian)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4044">line 4044</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss156.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss156.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>[0] \tan ζ coefficient (radians)
[1] \tan^3 ζ coefficient (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".refro"><span class="type-signature">(static) </span>refro<span class="signature">(zobs, hm, tdk, pmb, rh, wl, phi, tlr, eps)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Refraction</strong></p></p>
    



<div class="description">
    <p>Atmospheric refraction, for radio or optical/IR wavelengths.</p>
<ol>
<li>A suggested value for the TLR argument is 0.0065D0 (sign immaterial).
The refraction is significantly affected by TLR, and if studies of the
local atmosphere have been carried out a better TLR value may be
available.</li>
<li>A suggested value for the EPS argument is 1D−8. The result is usually at
least two orders of magnitude more computationally precise than the
supplied EPS value.</li>
<li>The routine computes the refraction for zenith distances up to and a
little beyond 90∘ using the method of Hohenkerk &amp; Sinclair (NAO
Technical Notes 59 and 63, subsequently adopted in the <em>Explanatory
Supplement to the Astronomical Almanac</em>, 1992 – see section 3.281).</li>
<li>The code is based on the AREF optical/IR refraction subroutine (HMNAO,
September 1984, RGO: Hohenkerk 1985), with extensions to support the
radio case. The modifications to the original HMNAO optical/IR
refraction code which affect the results are:
<ul>
<li>The angle arguments have been changed to radians, any value of ZOBS is
allowed (see Note 6, below) and other argument values have been
limited to safe values.</li>
<li>Revised values for the gas constants are used, from Murray (1983).</li>
<li>A better model for P_s(T) has been adopted, from Gill (1982).</li>
<li>More accurate expressions for P_{w_o} have been adopted (again from
Gill 1982).</li>
<li>The formula for the water vapour pressure, given the saturation
pressure and the relative humidity, is from Crane (1976), expression
2.5.5.</li>
<li>Provision for radio wavelengths has been added using expressions
devised by A. T. Sinclair, RGO (Sinclair 1989). The refractivity model
is from Rueger (2002).</li>
<li>The optical refractivity for dry air is from IAG (1999).</li>
</ul>
</li>
<li>The radio refraction is chosen by specifying WL &gt;100 μm. Because the
algorithm takes no account of the ionosphere, the accuracy deteriorates
at low frequencies, below about 30 MHz.</li>
<li>Before use, the value of ZOBS is expressed in the range ±π. If this
ranged ZOBS is negative, the result REF is computed from its absolute
value before being made negative to match. In addition, if it has an
absolute value greater than 93∘, a fixed REF value equal to the result
for ZOBS =93∘ is returned, appropriately signed.</li>
<li>As in the original Hohenkerk &amp; Sinclair algorithm, fixed values of the
water vapour polytrope exponent, the height of the tropopause, and the
height at which refraction is negligible are used.</li>
<li>The radio refraction has been tested against work done by Iain Coulson,
JACH, (private communication 1995) for the James Clerk Maxwell
Telescope, Mauna Kea. For typical conditions, agreement at the ′′01
level is achieved for moderate ZD, worsening to perhaps ′′05 – ′′10 at
ZD 80∘. At hot and humid sea-level sites the accuracy will not be as
good.</li>
<li>It should be noted that the relative humidity RH is formally defined in
terms of “mixing ratio” rather than pressures or densities as is often
stated. It is the mass of water per unit mass of dry air divided by that
for saturated air at the same temperature and pressure (see Gill 1982).
The familiar ν=pw/ps or ν=ρw/ρs expressions can differ from the formal
definition by several percent, significant in the radio case.</li>
<li>The algorithm is designed for observers in the troposphere. The supplied
temperature, pressure and lapse rate are assumed to be for a point in
the troposphere and are used to define a model atmosphere with the
tropopause at 11km altitude and a constant temperature above that.
However, in practice, the refraction values returned for stratospheric
observers, at altitudes up to 25km, are quite usable.</li>
</ol>
<hr>
<p>References:</p>
<ol>
<li>Coulsen, I. 1995, private communication.</li>
<li>Crane, R.K., Meeks, M.L. (ed), 1976, “Refraction Effects in the Neutral
Atmosphere”, <em>Methods of Experimental Physics: Astrophysics 12B</em>,
Academic Press.</li>
<li>Gill, Adrian E. 1982, <em>Atmosphere-Ocean Dynamics</em>, Academic Press.</li>
<li>Hohenkerk, C.Y. 1985, private communication.</li>
<li>Hohenkerk, C.Y., &amp; Sinclair, A.T. 1985, <em>NAO Technical Note</em> No. 63,
Royal Greenwich Observatory.</li>
<li>International Association of Geodesy, XXIIth General Assembly,
Birmingham, UK, 1999, Resolution 3.</li>
<li>Murray, C.A. 1983, <em>Vectorial Astrometry</em>, Adam Hilger, Bristol.</li>
<li>Seidelmann, P.K. et al. 1992, <em>Explanatory Supplement to the
Astronomical Almanac</em>, Chapter 3, University Science Books.</li>
<li>Rueger, J.M. 2002, <em>Refractive Index Formulae for Electronic Distance
Measurement with Radio and Millimetre Waves</em>, in Unisurv Report S-68,
School of Surveying and Spatial Information Systems, University of New
South Wales, Sydney, Australia.</li>
<li>Sinclair, A.T. 1989, private communication.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>zobs</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observed zenith distance of the source (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>hm</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Height of the observer above sea level (metre)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tdk</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Ambient temperature at the observer (K)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pmb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Pressure at the observer (mb)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rh</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Relative humidity at the observer (range 0-1)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>wl</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Effective wavelength of the source (μm)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Latitude of the observer (radian, astronomical)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tlr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Temperature lapse rate in the troposphere (K per metre)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>eps</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Precision required to terminate iteration (radian)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line3748">line 3748</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss158.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss158.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Refraction: in vacuo ZD minus observed ZD (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".refz"><span class="type-signature">(static) </span>refz<span class="signature">(zu, refa, refb)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>Apply Refraction to ZD</strong></p></p>
    



<div class="description">
    <p>Adjust an unrefracted zenith distance to include the effect of
atmospheric refraction, using the simple Δζ=a\tan ζ+b\tan^3 ζ
model.</p>
<ol>
<li>
<p>This routine applies the adjustment for refraction in the opposite sense
to the usual one – it takes an unrefracted (in vacuo) position and
produces an observed (refracted) position, whereas the Δζ=atanζ+btan3ζ
model strictly applies to the case where an observed position is to have
the refraction removed. The unrefracted to refracted case is harder, and
requires an inverted form of the text-book refraction models; the formula
used here is based on the Newton-Raphson method. For the utmost numerical
consistency with the refracted to unrefracted model, two iterations are
carried out, achieving agreement at the 10^−11 arcsecond level for ζ=80∘.
The inherent accuracy of the model is, of course, far worse than this –
see the documentation for <a href="sla.html#.refco">sla.refco</a> for more information.</p>
</li>
<li>
<p>At ζ=83∘, the rapidly-worsening Δζ=atanζ+btan3ζ model is abandoned and
an empirical formula takes over:</p>
<pre><code>Δζ = F * (0∘.55445−0∘.01133*E+0∘.00202*E^2) /
         (1+0.28385*E+0.02390*E^2),
</code></pre>
<p>where E=90∘−ζ_true and F is a factor chosen to meet the Δζ=atanζ+btan3ζ
formula at ζ=83∘.
For optical/IR wavelengths, over a wide range of observer heights and
corresponding temperatures and pressures, the following levels of
accuracy (worst case) are achieved, relative to numerical integration
through a model atmosphere:
ζobs | error |
80∘  | ′′07  |
81∘  | ′′13  |
82∘  | ′′24  |
83∘  | ′′47  |
84∘  | ′′62  |
85∘  | ′′64  |
86∘  | 8′′   |
87∘  | 10′′  |
88∘  | 15′′  |
89∘  | 30′′  |
90∘  | 60′′  |
91∘  | 150′′ | &lt;high-altitude
92∘  | 400′′ | &lt;sites only
For radio wavelengths the errors are typically 50% larger than the
optical figures and by ζ=85∘ are twice as bad, worsening rapidly below
that. To maintain 1′′ accuracy down to ζ=85∘ at the Green Bank site,
Condon (2004) has suggested amplifying the amount of refraction predicted
by <a href="sla.html#.refz">sla.refz</a> below 10∘.8 elevation by the factor
(1+0.00195∗(10.8−E_topo)),
where E_topo is the unrefracted elevation in degrees.
The high-ZD model is scaled to match the normal model at the transition
point; there is no glitch.</p>
</li>
<li>
<p>See also the routine sla.refv, which performs the adjustment in
[x,y,z], and with the emphasis on speed rather than numerical accuracy.</p>
</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Condon, J.J., <em>Refraction Corrections for the GBT</em>, PTCS/PN/35.2, NRAO
Green Bank, 2004.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>zu</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Unrefracted zenith distance of the source (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>refa</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>\tan ζ coefficient (radians)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>refb</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>\tan^3 ζ coefficient (radians)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line4123">line 4123</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss160.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss160.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Refracted zenith distance (radians)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".ue2pv"><span class="type-signature">(static) </span>ue2pv<span class="signature">(date, u)</span><span class="type-signature"> &rarr; {Array}</span></h4>
    

    
    <p class="summary"><p><strong>Pos/Vel from Universal Elements</strong></p></p>
    



<div class="description">
    <p>Heliocentric position and velocity of a planet, asteroid or
comet, starting from orbital elements in the &quot;universal
variables&quot; form.</p>
<ol>
<li>The “universal” elements are those which define the orbit for the
purposes of the method of universal variables (see reference). They
consist of the combined mass of the two bodies, an epoch, and the
position and velocity vectors (arbitrary reference frame) at that epoch.
The parameter set used here includes also various quantities that can,
in fact, be derived from the other information. This approach is taken to
avoiding unnecessary computation and loss of accuracy. The supplementary
quantities are (i) α, which is proportional to the total energy of the
orbit, (ii) the heliocentric distance at epoch, (iii) the outwards
component of the velocity at the given epoch, (iv) an estimate of ψ,
the “universal eccentric anomaly” at a given date and (v) that date.</li>
<li>The companion routine is <a href="sla.html#.el2ue">sla.el2ue</a>. This takes the conventional
orbital elements and transforms them into the set of numbers needed by
the present routine. A single prediction requires one one call to
<a href="sla.html#.el2ue">sla.el2ue</a> followed by one call to the present routine; for
convenience, the two calls are packaged as the routine <a href="sla.html#.planel">sla.planel</a>.
Multiple predictions may be made by again calling <a href="sla.html#.el2ue">sla.el2ue</a>
once, but then calling the present routine multiple times, which is
faster than multiple calls to <a href="sla.html#.planel">sla.planel</a>.
It is not obligatory to use <a href="sla.html#.el2ue">sla.el2ue</a> to obtain the parameters.
However, it should be noted that because <a href="sla.html#.el2ue">sla.el2ue</a> performs its
own validation, no checks on the contents of the array U are made by the
present routine.</li>
<li>DATE is the instant for which the prediction is required. It is in the
TT time scale (formerly Ephemeris Time, ET) and is a Modified Julian Date
(JD−2400000.5).</li>
<li>The universal elements supplied in the array U are in canonical units
(solar masses, AU and canonical days). The position and velocity are not
sensitive to the choice of reference frame. The <a href="sla.html#.el2ue">sla.el2ue</a>
routine in fact produces coordinates with respect to the J2000 equator
and equinox.</li>
<li>The algorithm was originally adapted from the EPHSLA program of D.H.P.
Jones (private communication, 1996). The method is based on Stumpff’s
Universal Variables.</li>
</ol>
<hr>
<p>References:</p>
<ul>
<li>Everhart, E. &amp; Pitkin, E.T., <em>Am. J. Phys.</em> 51, 712, 1983.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>date</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Date (TT Modified Julian Date = JD-2400000.5)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>u</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>Universal orbital elements (updated; Note 1)
[0] combined mass (M+m)
[1] total energy of the orbit (α)
[2] reference (osculating) epoch (t0)
[3-5] position at reference epoch (r0)
[6-8] velocity at reference epoch (v0)
[9] heliocentric distance at reference epoch
[10] r0.v0
[11] date (t)
[12] universal eccentric anomaly (ψ) of date, approx</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line2748">line 2748</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss180.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss180.html</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If radius vector is zero.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">RangeError</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the algorithm fails to converge.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Heliocentric [x,y,z,\dot x,\dot y,\dot z], equatorial,
J2000 (AU, AU/s; Note 1)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".zd"><span class="type-signature">(static) </span>zd<span class="signature">(ha, dec, phi)</span><span class="type-signature"> &rarr; {Number}</span></h4>
    

    
    <p class="summary"><p><strong>h,δ to Zenith Distance</strong></p></p>
    



<div class="description">
    <p>Hour angle and declination to zenith distance.</p>
<ol>
<li>The latitude must be geodetic. In critical applications, corrections for
polar motion should be applied (see @link{sla.polmo}).</li>
<li>In some applications it will be important to specify the correct type
of hour angle and declination in order to produce the required type of
azimuth and elevation. In particular, it may be important to distinguish
between elevation as affected by refraction, which would require the
<em>observed</em> [h,δ], and the elevation <em>in vacuo</em>, which would require the
<em>topocentric</em> [h,δ]. If the effects of diurnal aberration can be
neglected, the <em>apparent</em> [h,δ] may be used instead of the topocentric
[h,δ].</li>
<li>No range checking of arguments is done.</li>
<li>In applications which involve many zenith distance calculations, rather
than calling the present routine it will be more efficient to use inline
code, having previously computed fixed terms such as sine and cosine of
latitude, and perhaps sine and cosine of declination.</li>
</ol>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ha</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Hour Angle in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dec</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Declination in radians</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phi</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            

            

            <td class="description last"><p>Observatory latitude in radians</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="visplot_sla.js.html">visplot_sla.js</a>, <a href="visplot_sla.js.html#line5077">line 5077</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss188.html">http://star-www.rl.ac.uk/docs/sun67.htx/sun67ss188.html</a></li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Zenith distance (radians, 0−π)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Number</span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="helper.html">helper</a></li><li><a href="serializer.html">serializer</a></li><li><a href="sla.html">sla</a></li></ul><h3>Classes</h3><ul><li><a href="Driver.html">Driver</a></li><li><a href="Graph.html">Graph</a></li><li><a href="Night.html">Night</a></li><li><a href="SkyGraph.html">SkyGraph</a></li><li><a href="Target.html">Target</a></li><li><a href="TargetList.html">TargetList</a></li></ul><h3>Global</h3><ul><li><a href="global.html#assertAlmostEqual">assertAlmostEqual</a></li><li><a href="global.html#assertEqual">assertEqual</a></li><li><a href="global.html#config">config</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Thu Apr 21 2022 19:28:34 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>